!function(t){"use strict";function r(t){t.updateScore=function(t){window.location.href="gamee://score/"+t},t.requestController=function(t){window.location.href="gamee://request-controller/"+t},t.gameOver=function(){window.location.href="gamee://game-over"},t.gameStart=function(){e(function(){window.location.href="gamee://game-start"},100)},t.gameLoaded=function(){window.location.href="gamee://game-loaded"},t.type="gamee-mobile"}function u(t){var e=window.parent.gameeSimulator;t.updateScore=function(t){e.updateScore(t)},t.requestController=function(t){e.requestController(t)},t.gameOver=function(){e.gameOver()},t.gameStart=function(){e.gameStart()},t.gameLoaded=function(){e.gameLoaded()},t.type="gamee-simulator"}function a(t){var e=window.parent;t.updateScore=function(t){e.postMessage(["score",t],"*")},t.requestController=function(t){e.postMessage(["request-controller",t],"*")},t.additionalController=function(t){e.postMessage(["additional-controller",t],"*")},t.gameOver=function(){e.postMessage(["game-over"],"*")},t.gameStart=function(){e.postMessage(["game-start"],"*")},t.gamePaused=function(){e.postMessage(["game-paused"],"*")},t.gameLoaded=function(){e.postMessage(["game-loaded"],"*")},t.type="gamee-web"}var e=t.setTimeout,o={updateScore:function(t){},requestController:function(t){},additionalController:function(t){},gameOver:function(){},gameStart:function(){},gameLoaded:function(){},type:"no-gamee"},n=navigator.userAgent.toLowerCase();/iphone|ipod|ipad/.test(n)?window.self!==window.top?a(o):r(o):/gamee\/[0-9\.]+$/.test(n)?r(o):window.parent?a(o):window.parent&&window.parent.gameeSimulator?u(o):console.error("No gamee enviroment matched"),t.$gameeNative=o}(this);var gamee=function(t){"use strict";function r(t,e,o){t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent&&t.attachEvent("on"+e,o)}function a(t){return function(e){return e&&e.keyCode||(e||(e=window.event),e.which&&(e.keyCode=e.which)),t(e)}}var e,o=function(){},n={};return Object.defineProperty(n,"score",{get:function(){return e},set:function(o){e=o,t.$gameeNative.updateScore(e)}}),n.gameOver=function(){t.$gameeNative.gameOver()},n.gameStart=function(){t.$gameeNative.gameStart()},n.gameLoaded=function(){t.$gameeNative.gameLoaded()},n.onPause=o,n.onStop=o,n.onRestart=o,n.onMute=o,n.onUnmute=o,n.onUnpause=o,n.onResume=function(){n.onUnpause()},n._keydown=function(e){r(t,"keydown",a(e))},n._keyup=function(e){r(t,"keyup",a(e))},"gamee-web"===t.$gameeNative.type&&(n._keydown(function(t){switch(t.keyCode){case 80:n.onPause(),$gameeNative.gamePaused();break;case 82:n.onRestart()}}),r(t,"message",function(t){switch(t.data[0]){case"pause":n.onPause();break;case"resume":n.onResume();break;case"restart":window.focus(),n.onRestart();break;case"mute":n.onMute();break;case"button_button_down":n.controller.trigger("keydown",{button:"button"});break;case"button_button_up":n.controller.trigger("keyup",{button:"button"});break;case"button_left_up":n.controller.trigger("keyup",{button:"left"});break;case"button_left_down":n.controller.trigger("keydown",{button:"left"});break;case"button_right_down":n.controller.trigger("keydown",{button:"right"});break;case"button_right_up":n.controller.trigger("keyup",{button:"right"});break;case"button_up_down":n.controller.trigger("keydown",{button:"up"});break;case"button_up_up":n.controller.trigger("keyup",{button:"up"});break;case"button_down_down":n.controller.trigger("keydown",{button:"down"});break;case"button_down_up":n.controller.trigger("keyup",{button:"down"});break;case"button_a_down":n.controller.trigger("keydown",{button:"A"});break;case"button_a_up":n.controller.trigger("keyup",{button:"A"});break;case"button_b_down":n.controller.trigger("keydown",{button:"B"});break;case"button_b_up":n.controller.trigger("keyup",{button:"B"});break;default:throw Error("Unknown message")}})),n}(this);!function(t,e){"use strict";function n(t,e){var n=this;o.call(this),this._pressed=!0,this.key=t,this.keyCode=e,this.on("keydown",function(){n._pressed=!0}),this.on("keyup",function(){n._pressed=!1})}function r(){var t=this;o.call(this),this.buttons={},this.buttonAlias={},this.on("$keydown",function(e){e.button&&t.buttonAlias[e.button]&&(e.button=t.buttonAlias[e.button]),t.trigger("keydown",e)}),this.on("$keyup",function(e){e.button&&t.buttonAlias[e.button]&&(e.button=t.buttonAlias[e.button]),t.trigger("keyup",e)}),this.on("keydown",function(e){e.button&&t.buttons[e.button]&&t.buttons[e.button].trigger("keydown")}),this.on("keyup",function(e){e.button&&t.buttons[e.button]&&t.buttons[e.button].trigger("keyup")})}function u(){r.call(this),this.addButton(new n("button",32))}function a(){r.call(this),this.addButton(new n("left",37)),this.addButton(new n("right",39))}function i(){r.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("A",32))}function s(){r.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("down",40)),this.addButton(new n("A",32))}function c(){r.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("down",40)),this.addButton(new n("A",32)),this.addButton(new n("B",17))}function d(){r.call(this),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("A",32))}function p(){r.call(this),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("A",32)),this.addButton(new n("B",17))}function l(){r.call(this),this.addButton(new n("up",38)),this.addButton(new n("left",37)),this.addButton(new n("right",39)),this.addButton(new n("down",40))}function g(){var t=this;r.call(this),this.on("$touchstart",function(e){t.trigger("touchstart",e)}),this.on("$touchend",function(e){t.trigger("touchend",e)}),this.on("$touchmove",function(e){t.trigger("touchmove",e)}),this.on("$touchleave",function(e){t.trigger("touchleave",e)}),this.on("$touchcancel",function(e){t.trigger("touchcancel",e)})}function f(){var t=this;r.call(this),this.x=0,this.y=0,this.on("$change",function(e){t.x=e.position.x,t.y=e.position.y,t.trigger("change",e)})}function h(){f.call(this),this.addButton(new n("button",32))}function b(t,e){var o,n;if(!y[t])throw new Error("Unsupported controller type, "+t);if(e=e||{},n=new y[t],e.enableKeyboard&&n.enableKeyboard(),e.buttons)for(o in e.buttons)n.remapButton(o,e.buttons[o]);return n}var o=Bullet.constructor;e.controller={requestController:function(e,o){var n=b(e,o);return t.$gameeNative.requestController(e),w=n,n},additionalController:function(e,o){var n=b(e,o);return t.$gameeNative.additionalController(e),n},trigger:function(){if(!w)throw new Error("No controller present");w.trigger.apply(w,arguments)}},n.prototype=Object.create(o.constructor.prototype),n.constructor=n,n.prototype.isDown=function(){return this._pressed},r.prototype=Object.create(o.constructor.prototype),r.constructor=r,r.prototype.addButton=function(t){this.buttons[t.key]=t},r.prototype.enableKeyboard=function(){var t,o,n={},r=this;for(t in this.buttons)o=this.buttons[t],o.keyCode&&(n[o.keyCode]=o);e._keydown(function(t){var e=n[t.keyCode];e&&(t.preventDefault(),r.trigger("keydown",{button:e.key}))}),e._keyup(function(t){var e=n[t.keyCode];e&&(t.preventDefault(),r.trigger("keyup",{button:e.key}))})},r.prototype.remapButton=function(t,e){if(e.name&&(e=e.name),!this.buttons[t])throw Error("Button "+t+" was not found in controller");this.buttonAlias[t]=e.name,this.buttons[e.name]=this.buttons[t],delete this.buttons[t]},u.prototype=Object.create(r.prototype),u.prototype.constructor=u,a.prototype=Object.create(r.prototype),a.prototype.constructor=a,i.prototype=Object.create(r.prototype),i.prototype.constructor=i,s.prototype=Object.create(r.prototype),s.prototype.constructor=s,c.prototype=Object.create(r.prototype),c.prototype.constructor=c,d.prototype=Object.create(r.prototype),d.prototype.constructor=d,p.prototype=Object.create(r.prototype),p.prototype.constructor=p,l.prototype=Object.create(r.prototype),l.prototype.constructor=l,g.prototype=Object.create(g.prototype),g.prototype.constructor=g,f.prototype=Object.create(r.prototype),f.prototype.constructor=f,h.prototype=Object.create(f.prototype),h.prototype.constructor=h;var w,y={OneButton:u,TwoButtons:a,FourButtons:i,FiveButtons:s,SixButtons:c,FourArrows:l,Touch:g,Joystick:f,JoystickWithButton:h,TwoArrowsTwoButtons:p,TwoArrowsOneButton:d}}(this,gamee);