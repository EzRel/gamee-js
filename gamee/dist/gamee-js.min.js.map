{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///gamee-js.min.js","webpack:///webpack/bootstrap 289f0eff965f1c46466f","webpack:///./gamee/src/core.js","webpack:///./gamee/libs/shims.js","webpack:///./gamee/src/gameeAPI.js","webpack:///./gamee/src/platform_bridge.js","webpack:///./gamee/libs/bullet.js","webpack:///./gamee/src/game_controllers.js","webpack:///./gamee/src/index.js","webpack:///(webpack)/buildin/global.js"],"names":["root","factory","exports","module","define","amd","a","i","this","modules","__webpack_require__","moduleId","installedModules","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","global","core","undefined","_typeof","Symbol","iterator","obj","constructor","_game_controllers","controllers","newObj","key","default","createController","type","opts","btn","controller","controllerTypes","Error","enableKeyboard","buttons","remapButton","noop","cache","internals","VERSION","CAPABILITIES","variant","soundUnlocked","onReady","onGameStart","gameeInit","ctrlType","ctrlOpts","capabilities","cb","allOk","cap","Array","isArray","length","indexOf","native","createRequest","version","responseData","error","platform","requestController","_bindKeyboardTriggers","err","bind","addEventListener","ev","data","trigger","button","gameLoadingProgress","percentageSoFar","percentage","gameReady","updateScore","score","opt_ghostSign","parseInt","ghostSign","gameOver","opt_replayData","requestData","replayData","gameSave","share","state","JSON","stringify","requestSocial","startSignal","replay","ghostMode","mainController","additionalController","gameeNative","apply","arguments","_keydown","fn","wrapKeyEvent","_keyup","OneButton","OneButtonController","TwoButtons","TwoButtonController","FourButtons","FourButtonController","FiveButtons","FiveButtonController","SixButtons","SixButtonController","FourArrows","FourArrowController","Touch","TouchController","Joystick","JoystickController","JoystickWithButton","JoystickButtonController","TwoArrowsTwoButtons","TwoArrowsTwoButtonsController","TwoArrowsOneButton","TwoArrowsOneButtonController","TwoActionButtons","TwoActionButtonsController","registerPlatform","platformAPI","CustomEmitter","delegate","method","eventTarget","document","createDocumentFragment","forEach","keyCode","window","event","which","ce","CustomEvent","preventDefault","defaultPrevented","e","params","evt","origPrevent","bubbles","cancelable","detail","createEvent","initCustomEvent","Event","win","doc","docHijack","old","v","addListen","addEvent","on","self","attachEvent","returnValue","stopPropagation","cancelBubble","Element","all","Gamee","GameeEmitter","_core","_shims","emitter","_platform","cbError","toString","_controller","gameInit","controllType","controllOpts","opt_cb","opt_share","getPlatform","PlatformBridge","requests","_init","PostMessageBridge","endpoint","_gameeWin","MobileBridge","device","FacebookBridge","PlatformAPI","pause","callback","dispatchEvent","resume","ghostShow","ghostHide","mute","unmute","start","opt_replay","opt_ghostMode","resetState","opt_resetState","instCount","opt_requestData","opt_callback","validateMethod","messId","preparedObject","request","messageId","doCall","_callback","id","doResponse","create","_resolveAPICall","response","postMessage","opt_data","console","webkit","messageHandlers","callbackHandler","_toDevice","_triggerMessage","parse","_methods","init","loadScript","FBInstant","initializeAsync","then","player","getDataAsync","saveState","gamee","sound","setLoadingProgress","startGameAsync","setScore","endGameAsync","setDataAsync","log","BulletClass","_self","_events","once","fnString","callbacks","off","fnToRemove","callbackObject","Bullet","Button","_pressed","Controller","buttonAlias","addButton","x","y","position","_bullet","isDown","keyCodes","oldName","newName","_gameeAPI","_platform_bridge","platformBridge","platformType","userAgent","navigator","toLowerCase","parent","test","referrer","top","gameeSimulator","g","Function","eval"],"mappings":"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","file":"gamee-js.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","/*! @preserve build time 2017-07-31 09:15:16 */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 6);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(global) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.core = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _game_controllers = __webpack_require__(5);\n\nvar controllers = _interopRequireWildcard(_game_controllers);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/**\r\n * @class core\r\n */\nvar core = exports.core = function () {\n\n    // # Gamee.js\n    // \n    // This file defines and expose a public API for games to communicate\n    // with Gamee*.\n    //\n    // Also it handles some requirements when Gamee is run in an desktop \n    // environment.\n    //\n    // \\* _later in the document Gamee will be referred as GameeApp to not\n    // be mistaken for word game_\n    //\n    // ** _GameeWebApp will refer to Gamee which is running in a desktop \n    // browser_\n\n    /** an empty function */\n    var noop = function noop() {};\n\n    var cache = {};\n\n    /** internal variables/constants (uppercase) coupled inside separate object for potential easy referencing */\n    var internals = {\n        VERSION: \"2.0\", // version of the gamee library\n        CAPABILITIES: [\"ghostMode\", \"saveState\", \"replay\", \"socialData\"], // supported capabilities\n        variant: 0, // for automating communication with server\n        soundUnlocked: false,\n        onReady: noop, // for intercepting real onReady because of behind the scenes variant handling\n        onGameStart: noop // for intercepting real onGameStart because of unlocking sound\n    };\n\n    /** ## gamee\r\n     *\r\n     * GameeApp interface for games. It is exposed as a `gamee` global\r\n     * object and games should only use its public methods and \r\n     * properties to communicate with the GameeApp. \r\n     *\r\n     * _There is also [$gameeNative](gamee_native.js.html) global object \r\n     * which handles internal parts of the communication._\r\n     */\n    var core = {};\n\n    //\n    // ## Signaling game state\n    //\n    // The game should signal the GameeApp its status (playing/game-over)\n    // and current score.\n    //\n\n    /** ### gamee.gameeInit\r\n     *\r\n     * Must be called first before any other gamee calls\r\n     * returns controller object the same way requestController did previously\r\n     * ctrlType/ctrlOpts - requested control type + options\r\n     * capabilities -> array of strings representing supported features:\r\n     * after the initialization onReady is invoked and after that game can use the api\r\n     */\n    core.gameeInit = function (ctrlType, ctrlOpts, capabilities, cb) {\n        // let's validate the array here, so that all backends can benefit from it\n        var allOk = true,\n            cap = {};\n        if (capabilities !== undefined && Array.isArray(capabilities)) {\n            for (var i = 0; i < capabilities.length; i++) {\n                if (typeof capabilities[i] !== \"string\" || internals.CAPABILITIES.indexOf(capabilities[i]) === -1) allOk = false;\n                cap[capabilities[i]] = true;\n            }\n        } else allOk = false;\n\n        if (!allOk) throw \"Capabilities array passed to gameeInit is void, malformed or unsupported capabilites requested.\";\n        // TODO remove\n        // gameeNative.gameeInit(core, internals.VERSION, ctrlType, allOk ? capabilities : []);\n\n        this.native.createRequest(\"init\", {\n            version: internals.VERSION,\n            controller: ctrlType,\n            capabilities: cap\n        }, function (responseData) {\n            // remember capabilities of the game\n            cache.capabilities = cap;\n\n            // might fail if controller of this type doesnt exist\n            var error = null;\n            try {\n                if (this.native.platform === \"web\" || this.native.platform === \"fb\") {\n                    responseData.controller = core.controller.requestController(ctrlType, { enableKeyboard: true });\n                    this._bindKeyboardTriggers(responseData.controller);\n                } else {\n                    responseData.controller = core.controller.requestController(ctrlType, {});\n                }\n            } catch (err) {\n                error = err;\n            }\n\n            cb(error, responseData);\n        }.bind(this));\n        // TODO remove\n        // return core.controller.requestController(ctrlType, ctrlOpts);\n    };\n\n    core._bindKeyboardTriggers = function (controller) {\n        global.addEventListener('message', function (ev) {\n            switch (ev.data[0]) {\n                case 'button_button_down':\n                    controller.trigger(\"keydown\", { button: \"button\" });\n                    break;\n\n                case 'button_button_up':\n                    controller.trigger(\"keyup\", { button: \"button\" });\n                    break;\n\n                case 'button_left_up':\n                    controller.trigger(\"keyup\", { button: \"left\" });\n                    break;\n\n                case 'button_left_down':\n                    controller.trigger(\"keydown\", { button: \"left\" });\n                    break;\n\n                case 'button_right_down':\n                    controller.trigger(\"keydown\", { button: \"right\" });\n                    break;\n\n                case 'button_right_up':\n                    controller.trigger(\"keyup\", { button: \"right\" });\n                    break;\n\n                case 'button_up_down':\n                    controller.trigger(\"keydown\", { button: \"up\" });\n                    break;\n\n                case 'button_up_up':\n                    controller.trigger(\"keyup\", { button: \"up\" });\n                    break;\n\n                case 'button_down_down':\n                    controller.trigger(\"keydown\", { button: \"down\" });\n                    break;\n\n                case 'button_down_up':\n                    controller.trigger(\"keyup\", { button: \"down\" });\n                    break;\n\n                case 'button_a_down':\n                    controller.trigger(\"keydown\", { button: \"A\" });\n                    break;\n\n                case 'button_a_up':\n                    controller.trigger(\"keyup\", { button: \"A\" });\n                    break;\n\n                case 'button_b_down':\n                    controller.trigger(\"keydown\", { button: \"B\" });\n                    break;\n\n                case 'button_b_up':\n                    controller.trigger(\"keyup\", { button: \"B\" });\n                    break;\n            }\n        });\n    };\n\n    /** ### gamee.gameLoadingProgress\r\n     *\r\n     * Indicates how much content is already loaded in %.\r\n     */\n    core.gameLoadingProgress = function () {\n        var percentageSoFar = 0;\n\n        return function (percentage) {\n            if (typeof percentage !== \"number\" || percentage < 0 || percentage > 100) throw \"Percentage passed to gameLoadingProgress out of bounds or not a number.\";else if (percentage > percentageSoFar) {\n                percentageSoFar = percentage;\n                this.native.createRequest(\"gameLoadingProgress\", { percentage: percentage });\n            }\n        };\n    }();\n\n    /** ### gamee.gameReady\r\n     *\r\n     * Notifies platform game can accept start command. \r\n     */\n    core.gameReady = function () {\n        this.native.createRequest(\"gameReady\");\n    };\n\n    /** ### gamee.gameStart\r\n     *\r\n     * Indicates that game is ready to be started (even after restart).\r\n     */\n    // core.gameStart = function () {\n    //     gameeNative.gameLoadingProgress(100); // FB requires this\n    //     gameeNative.gameStart(gamee);\n    // };\n\n    /** ### gamee.updateScore\r\n     *\r\n     * sends score to UI\r\n     */\n    core.updateScore = function (score, opt_ghostSign) {\n        if (typeof score !== \"number\") throw \"Score passed to updateScore is not a number.\";\n        var data = {\n            score: parseInt(score, 10)\n        };\n        if (opt_ghostSign) {\n            data.ghostSign = true;\n        }\n        this.native.createRequest(\"updateScore\", data);\n        // core.native.createRequest(method, requestData, callback);\n    };\n\n    /** ### gamee.gameOver\r\n     *\r\n     * Indicates the game has ended, the game is waiting for subsequent onGameStart.\r\n     * Data has the same format as data received in onReady callback.\r\n     * Data must be string = responsibility for turning data structure into string is left to the game!\r\n     */\n    core.gameOver = function (opt_replayData) {\n        // var allOk = ((data !== undefined) && (typeof data === \"string\")) || (data === undefined);\n        // if (!allOk) console.error(\"Data provided to gameOver function must be string.\");\n        // gameeNative.gameOver(gamee, internals.variant, allOk ? data : \"\");\n        var requestData = {};\n        if (opt_replayData) {\n            if (!opt_replayData.hasOwnProperty(\"variant\")) {\n                opt_replayData.variant = \"\";\n            }\n            if (!opt_replayData.hasOwnProperty(\"data\")) {\n                throw \"Replay data must have `data` property\";\n            }\n            requestData.replayData = opt_replayData;\n        }\n        core.native.createRequest(\"gameOver\", requestData);\n    };\n\n    /** ### gamee.gameSave\r\n     *\r\n     * Player has requested saving current game's state\r\n     * data must be string = responsibility for turning data structure into string is left to game!\r\n     * share must be expression evaluating to either true or false; it indicates, whether the game progress should be shared on feed\r\n     */\n    core.gameSave = function (data, share) {\n        var state;\n        if ((typeof data === \"undefined\" ? \"undefined\" : _typeof(data)) === \"object\") {\n            // gameeNative.gameSave(internals.variant, data, share ? 1 : 0);\n            try {\n                state = JSON.stringify(data);\n            } catch (err) {\n                throw \"data provided to gameSave function must be valid JSON: \" + err;\n            }\n            core.native.createRequest(\"saveState\", { state: state, share: share });\n        } else {\n            throw \"data provided to gameSave function must be object\";\n        }\n    };\n\n    core.requestSocial = function (cb) {\n        this.native.createRequest(\"requestSocial\", function (responseData) {\n            cb(null, responseData);\n        });\n    };\n\n    core.startSignal = function (data) {\n        var error;\n\n        if (data.replay && !cache.capabilities.replay) error = \"Game doesn't support replay. \";\n\n        if (data.ghostMode && !cache.capabilities.ghostMode) error = \"Game doesn't support ghost Mode. \";\n\n        return error;\n    };\n    //\n    // ## Private objects and methods\n    // These are internal objects in closed scope. Good to know about them\n    // when debugging.\n\n    //\n    // ## gamee.controller\n    //\n    // Namespace where the methods for controller are published.\n    // \n\n    /**\r\n     * TODO transform this into instance of gamee class\r\n     */\n    core.controller = {\n        /** ### mainController\r\n         * \r\n         * Current controller.\r\n         */\n        mainController: null,\n\n        /** ### requestController\r\n         *\r\n         * Factory method to create a controller. It creates the controller\r\n         * and signals to GameeApp which type the game requires\r\n         *\r\n         * You should called this method once before calling\r\n         * `gamee.gameStart()`.\r\n         *\r\n         * @param {String} type type of controller (see [controllerTypes](#controllertypes))\r\n         * @param {Object} [opts] optional controller options \r\n         * {'enableKeyboard': .., 'buttons': ...}\r\n         * @param {boolean} [opts.enableKeyboard] enable the keyboard\r\n         * @param {Object} [opts.buttons] remap buttons {'oldKey': 'newKey', \r\n         * 'left': 'break' ..}\r\n         */\n        requestController: function requestController(type, opts) {\n            if (type === \"FullScreen\") return null;\n\n            var controller = createController(type, opts);\n\n            this.mainController = controller;\n\n            return controller;\n        },\n\n        /** ### additionalController\r\n         * \r\n         * Construct an additional controller. Sometimes games require a\r\n         * different controller depending on platform (eg. touch on mobile, \r\n         e but Four Buttons on desktop)\r\n         *\r\n         * **This is currently supported only for GameeWebApp** as a way to \r\n         * have alternate keybinding. The game should request a type used \r\n         * for mobile platform and then some other as *additionalController*\r\n         * if alternate keybinding is needed;\r\n         */\n        // TODO remove this function\n        additionalController: function additionalController(type, opts) {\n            var controller = createController(type, opts);\n            gameeNative.additionalController(type);\n\n            return controller;\n        },\n\n        /** ### trigger\r\n         * \r\n         * Triggers and event for the controller\r\n         *\r\n         * This is called by GameeApp to trigger the *keydown*, *keyup*\r\n         * events. For more info see [Controller](#controller)\r\n         * \r\n         * @param {String} eventName name of the event\r\n         * @param {*} [data,...] data to pass for the event\r\n         *\r\n         */\n        trigger: function trigger() {\n            var i;\n\n            if (this.mainController) {\n                this.mainController.trigger.apply(this.mainController, arguments);\n            } else {\n                throw new Error('No controller present');\n            }\n        }\n    };\n\n    /** ### core._keydown\r\n     * \r\n     * A helper function to listen for `keydown` events on window object.\r\n     * \r\n     * @param {Function} fn callback to handle the event\r\n     */\n    core._keydown = function (fn) {\n        global.addEventListener('keydown', wrapKeyEvent(fn));\n    };\n\n    /** ### core._keyup\r\n     * \r\n     * A helper function to listen for `keyup` events on window object.\r\n     * \r\n     * @param {Function} fn callback to handle the event\r\n     */\n    core._keyup = function (fn) {\n        global.addEventListener('keyup', wrapKeyEvent(fn));\n    };\n\n    /** ### createController\r\n     * \r\n     * Function to create a controller.\r\n     *\r\n     * *see [requestController](#requestcontroller)\r\n     *\r\n     * @param {String} type\r\n     * @param {Object} [opts]\r\n     * @returns {Controller} controller\r\n     */\n    function createController(type, opts) {\n        var btn, controller;\n\n        if (!controllerTypes[type]) {\n            throw new Error('Unsupported controller type, ' + type);\n        }\n\n        opts = opts || {};\n\n        controller = new controllerTypes[type]();\n\n        if (opts.enableKeyboard) {\n            controller.enableKeyboard(core);\n        }\n\n        if (opts.buttons) {\n            for (btn in opts.buttons) {\n                controller.remapButton(btn, opts.buttons[btn]);\n            }\n        }\n\n        return controller;\n    }\n\n    /** ### controllerTypes\r\n     *\r\n     * List of controller types and their coresponding classes.\r\n     *\r\n     * *see [Controllers](#controllers) for more info*\r\n     * @requires Controller\r\n     */\n    var controllerTypes = {\n        'OneButton': controllers.OneButtonController,\n        'TwoButtons': controllers.TwoButtonController,\n        'FourButtons': controllers.FourButtonController,\n        'FiveButtons': controllers.FiveButtonController,\n        'SixButtons': controllers.SixButtonController,\n        'FourArrows': controllers.FourArrowController,\n        'Touch': controllers.TouchController,\n        'Joystick': controllers.JoystickController,\n        'JoystickWithButton': controllers.JoystickButtonController,\n        'TwoArrowsTwoButtons': controllers.TwoArrowsTwoButtonsController,\n        'TwoArrowsOneButton': controllers.TwoArrowsOneButtonController,\n        'TwoActionButtons': controllers.TwoActionButtonsController\n    };\n\n    core.registerPlatform = function (platformAPI) {\n        // platformAPI.addEventListener()\n        // TODO ?\n    };\n\n    return core;\n}();\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(7)))\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.CustomEmitter = CustomEmitter;\nexports.wrapKeyEvent = wrapKeyEvent;\n/**\r\n * @class CustomEvent\r\n */\n(function shimCustomEvent() {\n\ttry {\n\t\tvar ce = new window.CustomEvent('test');\n\t\tce.preventDefault();\n\t\tif (ce.defaultPrevented !== true) {\n\t\t\t// IE has problems with .preventDefault() on custom events\n\t\t\t// http://stackoverflow.com/questions/23349191\n\t\t\tthrow new Error('Could not prevent default');\n\t\t}\n\t} catch (e) {\n\t\tvar CustomEvent = function CustomEvent(event, params) {\n\t\t\tvar evt, origPrevent;\n\t\t\tparams = params || {\n\t\t\t\tbubbles: false,\n\t\t\t\tcancelable: false,\n\t\t\t\tdetail: undefined\n\t\t\t};\n\n\t\t\tevt = document.createEvent(\"CustomEvent\");\n\t\t\tevt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n\t\t\torigPrevent = evt.preventDefault;\n\t\t\tevt.preventDefault = function () {\n\t\t\t\torigPrevent.call(this);\n\t\t\t\ttry {\n\t\t\t\t\tObject.defineProperty(this, 'defaultPrevented', {\n\t\t\t\t\t\tget: function get() {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthis.defaultPrevented = true;\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn evt;\n\t\t};\n\n\t\tCustomEvent.prototype = window.Event.prototype;\n\t\twindow.CustomEvent = CustomEvent; // expose definition to window\n\t}\n})();\n\n//addEventListener polyfill 1.0 / Eirik Backer / MIT Licence\n(function (win, doc) {\n\tif (win.addEventListener) return; //No need to polyfill\n\n\tfunction docHijack(p) {\n\t\tvar old = doc[p];doc[p] = function (v) {\n\t\t\treturn addListen(old(v));\n\t\t};\n\t}\n\tfunction addEvent(on, fn, self) {\n\t\treturn (self = this).attachEvent('on' + on, function (e) {\n\t\t\te = e || win.event;\n\t\t\te.preventDefault = e.preventDefault || function () {\n\t\t\t\te.returnValue = false;\n\t\t\t};\n\t\t\te.stopPropagation = e.stopPropagation || function () {\n\t\t\t\te.cancelBubble = true;\n\t\t\t};\n\t\t\tfn.call(self, e);\n\t\t});\n\t}\n\tfunction addListen(obj, i) {\n\t\ti = obj.length;\n\t\tif (i) {\n\t\t\twhile (i--) {\n\t\t\t\tobj[i].addEventListener = addEvent;\n\t\t\t}\n\t\t} else {\n\t\t\tobj.addEventListener = addEvent;\n\t\t}\n\t\treturn obj;\n\t}\n\n\taddListen([doc, win]);\n\tif ('Element' in win) win.Element.prototype.addEventListener = addEvent; //IE8\n\telse {\n\t\t\t//IE < 8\n\t\t\tdoc.attachEvent('onreadystatechange', function () {\n\t\t\t\taddListen(doc.all);\n\t\t\t}); //Make sure we also init at domReady\n\t\t\tdocHijack('getElementsByTagName');\n\t\t\tdocHijack('getElementById');\n\t\t\tdocHijack('createElement');\n\t\t\taddListen(doc.all);\n\t\t}\n})(window, document);\n\n// naomik event emiter http://stackoverflow.com/a/24216547/1866147\n// usage:\n// function Example() {\n// \tCustomEmitter.call(this);\n// }\n\n// // run it\n// var e = new Example();\n\n// e.addEventListener(\"something\", function (event) {\n// \tconsole.log(event)\n// });\n\n// e.dispatchEvent(new Event(\"something\"));\nfunction CustomEmitter() {\n\tvar eventTarget = document.createDocumentFragment();\n\n\tfunction delegate(method) {\n\t\tthis[method] = eventTarget[method].bind(eventTarget);\n\t}\n\n\t[\"addEventListener\", \"dispatchEvent\", \"removeEventListener\"].forEach(delegate, this);\n}\n\n/** ### wrapKeyEvent \r\n * \r\n * Handle old IE event differences for key events\r\n * \r\n * @param {Function} fn callback\r\n */\nfunction wrapKeyEvent(fn) {\n\treturn function (ev) {\n\t\tif (!ev || !ev.keyCode) {\n\t\t\tif (!ev) {\n\t\t\t\tev = window.event;\n\t\t\t}\n\n\t\t\tif (ev.which) {\n\t\t\t\tev.keyCode = ev.which;\n\t\t\t}\n\t\t}\n\n\t\treturn fn(ev);\n\t};\n}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Gamee = exports.GameeEmitter = undefined;\n\nvar _core = __webpack_require__(0);\n\nvar _shims = __webpack_require__(1);\n\n/**\r\n * gameeAPI module desc\r\n * @module gameeAPI\r\n */\n\n/**\r\n * Emit events\r\n * @class GameeEmitter\r\n * @extends CustomEmitter\r\n */\nvar GameeEmitter = exports.GameeEmitter = function GameeEmitter() {\n  _shims.CustomEmitter.call(this);\n};\n\n/**\r\n * @class Gamee\r\n * @requires core\r\n * \r\n */\nvar Gamee = exports.Gamee = function Gamee(platform) {\n  /**\r\n   * @instance\r\n   * \r\n   * @fires gameeAPI:GameeEmitter~start\r\n   * @fires gameeAPI:GameeEmitter~mute\r\n   * @fires gameeAPI:GameeEmitter~unmute\r\n   * @fires gameeAPI:GameeEmitter~pause\r\n   * @fires gameeAPI:GameeEmitter~unpause\r\n   * @fires gameeAPI:GameeEmitter~ghostHide\r\n   * @fires gameeAPI:GameeEmitter~ghostShow\r\n   */\n  this.emitter = new GameeEmitter();\n  this._platform = platform;\n};\n\nGamee.prototype = function () {\n\n  var cbError = function cbError(err) {\n    if (err) {\n      throw \"Error \" + err.toString();\n    }\n  };\n\n  return {\n    _controller: _core.core.controller,\n    /**\r\n     * gameInit\r\n     * @memberof Gamee\r\n     * @param {string} controllType\r\n     * @param {object} controllOpts\r\n     * @param {string[]} capabilites\r\n     * @param {gameInitCallback} cb \r\n     */\n    gameInit: function gameInit(controllType, controllOpts, capabilities, cb) {\n      var result = _core.core.gameeInit(controllType, controllOpts, capabilities, cb);\n      // cb(null, result);\n    },\n\n    /**\r\n     * gameLoadingProgress\r\n     * \r\n     * NOTE: There are 2 signatures for this function\r\n     * \r\n     *     gamee.gameLoadingProgress()\r\n     * \r\n     * @memberof Gamee\r\n     * @param {number} percentage current loading progress\r\n     * @param {Gamee~voidCallback} [opt_cb] \r\n     * \r\n     */\n    gameLoadingProgress: function gameLoadingProgress(percentage, opt_cb) {\n      opt_cb = opt_cb || cbError;\n      _core.core.gameLoadingProgress(percentage);\n      opt_cb(null);\n    },\n\n    /**\r\n     * gameReady\r\n     * \r\n     * @memberof Gamee\r\n     * @param {Gamee~voidCallback} [opt_cb] \r\n     */\n    gameReady: function gameReady(opt_cb) {\n      opt_cb = opt_cb || cbError;\n      _core.core.gameReady();\n      opt_cb(null);\n    },\n\n    /**\r\n     * gameSave\r\n     * \r\n     * NOTE: There are 2 signatures for this function\r\n     * \r\n     *     gamee.gameSave(data, opt_cb)\r\n     *     gamee.gameSave(data, opt_share, opt_cb)\r\n     * \r\n     * @memberof Gamee\r\n     * @param {object} data current loading progress\r\n     * @param {boolean} [opt_share=false] \r\n     * @param {Gamee~voidCallback} [opt_cb] \r\n     * \r\n     */\n    gameSave: function gameSave(data, opt_share, opt_cb) {\n      var share = false,\n          cb;\n      if (typeof opt_share === 'undefined') cb = cbError;else if (typeof opt_share === 'function') cb = opt_share;else if (typeof opt_share === 'boolean') {\n        share = opt_share;\n        cb = opt_cb || cbError;\n      }\n      _core.core.gameSave(data, share);\n      cb(null);\n    },\n\n    /**\r\n     * getPlatform\r\n     * \r\n     * @memberof Gamee\r\n     * @returns {string} platform type can be android | ios | web | fb\r\n     */\n    getPlatform: function getPlatform() {\n      return this._platform;\n    },\n\n    /**\r\n     * updateScore\r\n     * \r\n     * @memberof Gamee\r\n     * @param {number} score\r\n     * @param {boolean} [opt_ghostSign=false] If true, score will be updated for ghost instead. \r\n     * @param {Gamee~voidCallback} [opt_cb] \r\n     */\n    updateScore: function updateScore(score, opt_ghostSign, opt_cb) {\n      if (typeof opt_ghostSign === \"function\") {\n        opt_cb = opt_ghostSign;\n        opt_ghostSign = undefined;\n      }\n      opt_cb = opt_cb || cbError;\n      _core.core.updateScore(score, opt_ghostSign);\n      opt_cb(null);\n    },\n\n    /**\r\n     * gameOver\r\n     * \r\n     * @memberof Gamee\r\n     * @param {Gamee~ReplayData} [opt_replayData]\r\n     * @param {Gamee~voidCallback} [opt_cb] \r\n     */\n    gameOver: function gameOver(opt_replayData, opt_cb) {\n      if (typeof opt_replayData === \"function\") {\n        opt_cb = opt_replayData;\n        opt_replayData = undefined;\n      }\n      opt_cb = opt_cb || cbError;\n      _core.core.gameOver(opt_replayData);\n      opt_cb(null);\n    },\n\n    /**\r\n     * requestSocialData\r\n     * \r\n     * @memberof Gamee\r\n     * @param {Gamee~requestSocialDataCallback} cb \r\n     */\n    requestSocial: function requestSocial(cb) {\n      var data = _core.core.requestSocial(cb);\n      //cb(null, data);\n    }\n  };\n\n  /**\r\n   * \r\n   * @typedef ReplayData\r\n   * @param {string} variant\r\n   * @param {string} data\r\n   */\n\n  /**\r\n   * This callback is displayed as part of the Requester class.\r\n   * @callback Gamee~voidCallback\r\n   * @param {string} responseCode\r\n   */\n\n  /**\r\n   * This callback is displayed as part of the Requester class.\r\n   * @callback Gamee~gameInitCallback\r\n   * @param {object} data\r\n   * @param {string} responseCode\r\n   */\n\n  /**\r\n   * This callback is displayed as part of the Requester class.\r\n   * @callback Gamee~requestSocialDataCallback\r\n   * @param {object} data\r\n   * @param {string} responseCode\r\n   */\n}();\n\n/**\r\n * Signals that game should start as normal|replay|ghost game. \r\n * Signal means there is no overlay over the game. \r\n * This signal is also being used for game restart. If previous \r\n * instance of the game was running, it should be terminated without\r\n * any additional calls and current progress should be tossed. \r\n * @event gameeAPI:GameeEmitter~start\r\n * @type {object}\r\n * @property {EventDetailStart} detail - Common property of events\r\n */\n\n/**\r\n * Data carried with start event. \r\n * @typedef EventDetailStart\r\n * @property {Gamee~voidCallback} callback - called after finishing task\r\n * @property {boolean} [opt_resetState=false] - if true, game must delete current progress and saved progress\r\n * @property {boolean} [opt_replay] - if true, game must run in replay mode\r\n * @property {boolean} [opt_ghostMode] - if true, game must run in ghost mode\r\n */\n\n/**\r\n * After that signal, game must silent all sounds immediately. \r\n * Game must remain silent until unmute signal occures. \r\n * @event gameeAPI:GameeEmitter~mute\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\n\n/**\r\n * After unmute signal, game can play sounds again. \r\n * @event gameeAPI:GameeEmitter~unmute\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\n\n/**\r\n * Pause signal means there appeared overlay over the game. Player\r\n * is unable to reach the context of the game anymore. So game should\r\n * pause all its acctions immediately. \r\n * @event gameeAPI:GameeEmitter~pause\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\n\n/**\r\n * Unpause signal means there is no overlay over the game anymore. \r\n * Game should continue with all previous actions. \r\n * @event gameeAPI:GameeEmitter~unpause\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\n\n/**\r\n * Signal ghostHide can appear only if game is running in ghost mode.\r\n * Game should hide ghost behavior and look like exactly as game without \r\n * the ghost (if this is possible). \r\n * @event gameeAPI:GameeEmitter~ghostHide\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\n\n/**\r\n * Signal ghostShow can appear only if game is running in ghost mode. \r\n * Game should show ghost again if it was hidden. If ghost died or ended\r\n * while it was hidden, game should point that out, so the player can understand\r\n * why the ghost is not visible anymore.  \r\n * @event gameeAPI:GameeEmitter~ghostShow\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\n\n/**\r\n * Data carried with various events. Contains only callback method. \r\n * @typedef {object} EventDetailVoid\r\n * @property {Gamee~voidCallback} callback - call after finishing task\r\n */\n\n/**\r\n * @type {function}\r\n * @param {MyEvent} e - The observable event.\r\n * @listens gameeAPI:GameeEmitter~event:snowball\r\n */\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.PlatformAPI = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.PlatformBridge = PlatformBridge;\nexports.PostMessageBridge = PostMessageBridge;\nexports.MobileBridge = MobileBridge;\nexports.FacebookBridge = FacebookBridge;\n\nvar _core = __webpack_require__(0);\n\n/**\r\n * \r\n * @requires core\r\n * \r\n * @typedef PlatformAPI\r\n * @param {EventTarget} emitter\r\n * @param {function} _pause\r\n * @param {function} _resume\r\n * @param {function} _ghostShow\r\n * @param {function} _ghostHide\r\n * @param {function} _mute\r\n * @param {function} _unmute\r\n * @param {function} _start\r\n */\nvar PlatformAPI = exports.PlatformAPI = {\n\temitter: null,\n\tpause: function pause(cb) {\n\t\tvar event = new CustomEvent('pause', {\n\t\t\tdetail: {\n\t\t\t\tcallback: cb\n\t\t\t}\n\t\t});\n\t\tthis.emitter.dispatchEvent(event);\n\t},\n\tresume: function resume(cb) {\n\t\tvar event = new CustomEvent('resume', {\n\t\t\tdetail: {\n\t\t\t\tcallback: cb\n\t\t\t}\n\t\t});\n\t\tthis.emitter.dispatchEvent(event);\n\t},\n\tghostShow: function ghostShow(cb) {\n\t\tvar event = new CustomEvent('ghostShow', {\n\t\t\tdetail: {\n\t\t\t\tcallback: cb\n\t\t\t}\n\t\t});\n\t\tthis.emitter.dispatchEvent(event);\n\t},\n\tghostHide: function ghostHide(cb) {\n\t\tvar event = new CustomEvent('ghostHide', {\n\t\t\tdetail: {\n\t\t\t\tcallback: cb\n\t\t\t}\n\t\t});\n\t\tthis.emitter.dispatchEvent(event);\n\t},\n\tmute: function mute(cb) {\n\t\tvar event = new CustomEvent('mute', {\n\t\t\tdetail: {\n\t\t\t\tcallback: cb\n\t\t\t}\n\t\t});\n\t\tthis.emitter.dispatchEvent(event);\n\t},\n\tunmute: function unmute(cb) {\n\t\tvar event = new CustomEvent('unmute', {\n\t\t\tdetail: {\n\t\t\t\tcallback: cb\n\t\t\t}\n\t\t});\n\t\tthis.emitter.dispatchEvent(event);\n\t},\n\tstart: function start(data, cb) {\n\t\tvar event = new CustomEvent('start', {\n\t\t\tdetail: {\n\t\t\t\tcallback: cb\n\t\t\t}\n\t\t});\n\n\t\tvar error = _core.core.startSignal(data);\n\t\tif (error) {\n\t\t\tcb(error);\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.replay) event.detail.opt_replay = true;\n\t\tif (data.ghostMode) event.detail.opt_ghostMode = true;\n\t\tif (data.resetState) event.detail.opt_resetState = true;\n\n\t\tthis.emitter.dispatchEvent(event);\n\t}\n};\n\n/**\r\n * @class PlatformBridge\r\n * \r\n */\nfunction PlatformBridge() {\n\tthis.requests = {};\n\tthis.platform = \"\";\n\tthis._init();\n}\n\nPlatformBridge.prototype = {\n\tinstCount: 0,\n\t_init: function _init() {},\n\tcreateRequest: function createRequest(method, opt_requestData, opt_callback) {\n\t\tif (!this.validateMethod(method)) return;\n\t\tif (typeof opt_requestData === 'function') {\n\t\t\topt_callback = opt_requestData;\n\t\t\topt_requestData = undefined;\n\t\t}\n\n\t\tvar messId = this.instCount++;\n\n\t\tif (typeof opt_callback !== 'undefined') {\n\t\t\tthis.requests[messId] = opt_callback;\n\t\t}\n\n\t\tvar preparedObject = {\n\t\t\trequest: {\n\t\t\t\tmethod: method,\n\t\t\t\tmessageId: messId,\n\t\t\t\tdata: null\n\t\t\t}\n\t\t};\n\n\t\tthis.doCall(preparedObject, opt_requestData);\n\t},\n\tvalidateMethod: function validateMethod(method) {\n\t\treturn method === \"gameLoadingProgress\" ? false : true;\n\t},\n\t/**\r\n  * @abstract\r\n  */\n\tdoCall: function doCall(preparedObject, requestData) {\n\t\tthrow \"Not implemented\";\n\t},\n\t_callback: function _callback(id, responseData) {\n\t\tvar cb = this.requests[id];\n\t\tdelete this.requests[id];\n\t\tif (cb) cb(responseData);\n\t},\n\t/**\r\n  * @abstract\r\n  */\n\tdoResponse: function doResponse(preparedObject, responseData) {\n\t\tthrow \"Not implemented\";\n\t}\n};\n\n/**\r\n * @class PostMessageBridge\r\n * @requires PlatformBridge\r\n */\nfunction PostMessageBridge(endpoint) {\n\tthis._gameeWin = endpoint;\n\tPlatformBridge.call(this);\n\tthis.platform = \"web\";\n}\n\nPostMessageBridge.prototype = Object.create(PlatformBridge.prototype);\nPostMessageBridge.prototype.constructor = PostMessageBridge;\n\nPostMessageBridge.prototype._init = function () {\n\n\twindow.addEventListener('message', function (ev) {\n\t\t// if(ev.origin === \"source we want\")\n\t\t// console.log(\"_triggerMessage detail: \" + ev.detail);\n\t\t// console.log(\"_triggerMessage data: \" + ev.data);\n\t\tvar data;\n\t\tif (_typeof(ev.detail) === \"object\" && typeof ev.detail !== null) {\n\t\t\tdata = ev.detail;\n\t\t} else if (_typeof(ev.data) === \"object\") {\n\t\t\tdata = ev.data;\n\t\t} else {\n\t\t\t// message is not from native platform\n\t\t\treturn;\n\t\t}\n\t\t// this is request\n\t\tif (data.request && data.request.method && typeof data.request.messageId !== \"undefined\") {\n\t\t\tthis._resolveAPICall(data.request.method, data.request.messageId, data.request.data);\n\t\t}\n\t\t// this is reponse\n\t\telse if (data.response && typeof data.response.messageId !== \"undefined\") {\n\t\t\t\tif (data.error) throw data.error;\n\t\t\t\tthis._callback(data.response.messageId, data.response.data);\n\t\t\t}\n\t\t// else this message target is not this framework\n\t}.bind(this), false);\n};\n\nPostMessageBridge.prototype.doCall = function (preparedObject, requestData) {\n\tif ((typeof requestData === 'undefined' ? 'undefined' : _typeof(requestData)) === \"object\") {\n\t\tpreparedObject.request.data = requestData || {};\n\t}\n\tthis._gameeWin.postMessage(preparedObject, \"*\");\n};\n\nPostMessageBridge.prototype.doResponse = function (messageId, responseData) {\n\tvar preparedObject = {\n\t\tversion: this.version,\n\t\tresponse: {\n\t\t\tmessageId: messageId\n\t\t}\n\t};\n\n\tif (responseData) preparedObject.data = responseData;\n\n\tthis._gameeWin.postMessage(preparedObject, \"*\");\n};\n\nPostMessageBridge.prototype._resolveAPICall = function (method, messageId, opt_data) {\n\tvar cb = this.doResponse.bind(this, messageId);\n\n\tswitch (method) {\n\t\tcase \"pause\":\n\t\t\tPlatformAPI.pause(cb);\n\t\t\tbreak;\n\t\tcase \"resume\":\n\t\t\tPlatformAPI.resume(cb);\n\t\t\tbreak;\n\t\tcase \"mute\":\n\t\t\tPlatformAPI.mute(cb);\n\t\t\tbreak;\n\t\tcase \"unmute\":\n\t\t\tPlatformAPI.unmute(cb);\n\t\t\tbreak;\n\t\tcase \"ghostShow\":\n\t\t\tPlatformAPI.ghostShow(cb);\n\t\t\tbreak;\n\t\tcase \"ghostHide\":\n\t\t\tPlatformAPI.ghostHide(cb);\n\t\t\tbreak;\n\t\tcase \"start\":\n\t\t\tif (!opt_data) {\n\t\t\t\tthrow \"Method _start missing params\";\n\t\t\t}\n\t\t\tPlatformAPI.start(opt_data, cb);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tconsole.error(\"Unknown method call\");\n\t}\n};\n\n/**\r\n * @class MobileBridge\r\n * @requires PlatformBridge\r\n * \r\n */\nfunction MobileBridge(device) {\n\tthis.device = device;\n\tPostMessageBridge.call(this);\n\tthis.platform = \"mobile\";\n}\n\nMobileBridge.prototype = Object.create(PostMessageBridge.prototype);\nMobileBridge.prototype.constructor = MobileBridge;\n\nMobileBridge.prototype._init = function () {\n\tPostMessageBridge.prototype._init.call(this);\n\tif (this.device === \"ios\") {\n\t\tthis._gameeWin = webkit.messageHandlers.callbackHandler;\n\t} else if (this.device === \"android\") {\n\t\tthis._gameeWin = _toDevice;\n\t} else {\n\t\tthrow \"Unknown device used in webkit bridge\";\n\t}\n\n\twindow._triggerMessage = function (data) {\n\t\ttry {\n\t\t\tdata = JSON.parse(data); // message is custom message from IOS/android platform\n\t\t} catch (err) {\n\t\t\tthrow \"Couldn't parse message from native app: \\n\" + data + \"\\n\" + err;\n\t\t}\n\t\tthis.dispatchEvent(new CustomEvent(\"message\", { detail: data }));\n\t};\n};\n\nMobileBridge.prototype.doCall = function (preparedObject, requestData) {\n\tif ((typeof requestData === 'undefined' ? 'undefined' : _typeof(requestData)) === \"object\") {\n\t\tpreparedObject.request.data = requestData || {};\n\t}\n\n\tif (this.device === \"android\") // stringify data for android devices, but not for ios\n\t\tpreparedObject = JSON.stringify(preparedObject);\n\n\tthis._gameeWin.postMessage(preparedObject, \"*\");\n};\n\n/**\r\n * @class FacebookBridge\r\n * @requires PlatformBridge\r\n */\nfunction FacebookBridge() {\n\tPlatformBridge.call(this);\n\tthis.platform = \"fb\";\n}\n\nFacebookBridge.prototype = Object.create(PlatformBridge.prototype);\nFacebookBridge.prototype.constructor = FacebookBridge;\n\nFacebookBridge.prototype._init = function () {};\n\nFacebookBridge.prototype.createRequest = function (method, opt_requestData, opt_callback) {\n\tif (typeof opt_requestData === 'function') {\n\t\topt_callback = opt_requestData;\n\t\topt_requestData = undefined;\n\t}\n\n\ttry {\n\t\tthis._methods[method](opt_callback, opt_requestData);\n\t} catch (err) {\n\t\tthrow err;\n\t}\n};\n\nFacebookBridge.prototype.validateMethod = function (method) {\n\treturn true;\n};\n\nFacebookBridge.prototype._methods = {\n\tinit: function init(cb, data) {\n\t\tvar scripts = \"https://connect.facebook.net/en_US/fbinstant.2.1.js\"; // TODO?\n\t\tloadScript(scripts, function () {\n\t\t\tFBInstant.initializeAsync().then(function (v) {\n\t\t\t\tFBInstant.player.getDataAsync(['gamee']).then(function (data) {\n\t\t\t\t\tvar saveState = data.gamee || null;\n\t\t\t\t\tcb({\n\t\t\t\t\t\tsaveState: saveState,\n\t\t\t\t\t\treplayData: null,\n\t\t\t\t\t\tsound: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, function (e) {\n\t\t\t\tthrow e;\n\t\t\t});\n\t\t});\n\t},\n\tgameLoadingProgress: function gameLoadingProgress(cb, data) {\n\t\tFBInstant.setLoadingProgress(data.percentage);\n\t},\n\tgameReady: function gameReady() {\n\t\tFBInstant.setLoadingProgress(100);\n\t\tFBInstant.startGameAsync().then(function () {\n\t\t\tPlatformAPI.start({}, function () {});\n\t\t});\n\t},\n\tupdateScore: function updateScore(cb, data) {\n\t\tFBInstant.setScore(data.score);\n\t},\n\tgameOver: function gameOver() {\n\t\tFBInstant.endGameAsync().then(function () {\n\t\t\tPlatformAPI.start({}, function () {});\n\t\t});\n\t},\n\tsaveState: function saveState(cb, data) {\n\t\tFBInstant.player.setDataAsync({\n\t\t\t\"gamee\": data.state\n\t\t}).then(function () {\n\t\t\tconsole.log('FB: data is saved');\n\t\t});\n\t}\n};\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar BulletClass = function BulletClass() {\n    var _self = this,\n        _events = {};\n\n    _self.on = function (event, fn, once) {\n        if (arguments.length < 2 || typeof event !== \"string\" || typeof fn !== \"function\") return;\n\n        var fnString = fn.toString();\n\n        // if the named event object already exists in the dictionary...\n        if (typeof _events[event] !== \"undefined\") {\n            // add a callback object to the named event object if one doesn't already exist.\n            if (typeof _events[event].callbacks[fnString] === \"undefined\") {\n                _events[event].callbacks[fnString] = {\n                    cb: fn,\n                    once: !!once\n                };\n            } else if (typeof once === \"boolean\") {\n                // the function already exists, so update it's 'once' value.\n                _events[event].callbacks[fnString].once = once;\n            }\n        } else {\n            // create a new event object in the dictionary with the specified name and callback.\n            _events[event] = {\n                callbacks: {}\n            };\n\n            _events[event].callbacks[fnString] = { cb: fn, once: !!once };\n        }\n    };\n\n    _self.once = function (event, fn) {\n        _self.on(event, fn, true);\n    };\n\n    _self.off = function (event, fn) {\n        if (typeof event !== \"string\" || typeof _events[event] === \"undefined\") return;\n\n        // remove just the function, if passed as a parameter and in the dictionary.\n        if (typeof fn === \"function\") {\n            var fnString = fn.toString(),\n                fnToRemove = _events[event].callbacks[fnString];\n\n            if (typeof fnToRemove !== \"undefined\") {\n                // delete the callback object from the dictionary.\n                delete _events[event].callbacks[fnString];\n            }\n        } else {\n            // delete all functions in the dictionary that are\n            // registered to this event by deleting the named event object.\n            delete _events[event];\n        }\n    };\n\n    _self.trigger = function (event, data) {\n        if (typeof event !== \"string\" || typeof _events[event] === \"undefined\") return;\n\n        for (var fnString in _events[event].callbacks) {\n            var callbackObject = _events[event].callbacks[fnString];\n\n            if (typeof callbackObject.cb === \"function\") callbackObject.cb(data);\n            if (typeof callbackObject.once === \"boolean\" && callbackObject.once === true) _self.off(event, callbackObject.cb);\n        }\n    };\n};\n\nvar Bullet = exports.Bullet = new BulletClass();\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.BulletClass = undefined;\nexports.Button = Button;\nexports.Controller = Controller;\nexports.OneButtonController = OneButtonController;\nexports.TwoButtonController = TwoButtonController;\nexports.TwoActionButtonsController = TwoActionButtonsController;\nexports.FourButtonController = FourButtonController;\nexports.FiveButtonController = FiveButtonController;\nexports.SixButtonController = SixButtonController;\nexports.TwoArrowsOneButtonController = TwoArrowsOneButtonController;\nexports.TwoArrowsTwoButtonsController = TwoArrowsTwoButtonsController;\nexports.FourArrowController = FourArrowController;\nexports.TouchController = TouchController;\nexports.JoystickController = JoystickController;\nexports.JoystickButtonController = JoystickButtonController;\n\nvar _bullet = __webpack_require__(4);\n\n/**\r\n * @module game_controllers\r\n */\n\n/** ## Bullet \r\n *\r\n * [Bullet.js](https://github.com/munkychop/bullet) is used as pub/sub\r\n * library. \r\n * \r\n * The controller and its buttons are instance of Bullet.\r\n */\nvar BulletClass = exports.BulletClass = _bullet.Bullet.constructor;\n\n/** ## Button\r\n *\r\n * Represenation of a controller button. It is a child of \r\n * [Bullet](https://github.com/munkychop/bullet), so you can\r\n * subscribe for events triggered on it. \r\n * \r\n * @class Button\r\n * @param {String} key name of the button\r\n * @param {Number} keyCode keycode for the key to represent the button\r\n * on keyboard\r\n */\nfunction Button(key, keyCode) {\n\tvar self = this;\n\n\tBulletClass.call(this);\n\n\tthis._pressed = true;\n\n\tthis.key = key;\n\tthis.keyCode = keyCode;\n\n\tthis.on('keydown', function () {\n\t\tself._pressed = true;\n\t});\n\n\tthis.on('keyup', function () {\n\t\tself._pressed = false;\n\t});\n}\n\nButton.prototype = Object.create(BulletClass.constructor.prototype);\nButton.constructor = Button;\n\n/** ### isDown\r\n * \r\n * Ask if the button is currently pressed.\r\n *\r\n * @return {Boolean} true if the button is currently pressed\r\n */\nButton.prototype.isDown = function () {\n\treturn this._pressed;\n};\n\n/** ## Controller\r\n * \r\n * Controller has a collection of [buttons](#buttons).\r\n * It is a child of \r\n * [Bullet](https://github.com/munkychop/bullet), so you can \r\n * subscribe for events triggered on it. \r\n *\r\n * Controllers will get all the events for its buttons so you can\r\n * listen for them globaly from controller or individualy on every\r\n * button.\r\n *\r\n * ```javascript\r\n * controller.on('keydown', function(data) {\r\n *   console.log('button ' + data.button + ' is pressed');\r\n * });\r\n *\r\n * controller.buttons.left.on('keydown', function() {\r\n *   console.log('button left is pressed');\r\n * });\r\n * ```\r\n * \r\n * @class Controller\r\n */\nfunction Controller() {\n\tvar self = this;\n\n\tBulletClass.call(this);\n\n\t// ### buttons\n\t//\n\t// Map of controller's [buttons](#button) by their name.\n\t//\n\t// ```javascript\n\t// controller.buttons.left // Button('left', ..)\n\t// ```\n\tthis.buttons = {};\n\n\t// ### buttonAlias\n\t//\n\t// Map of remapped buttons.\n\t//\n\t// *see [remapButton](#remapbutton) for more info*\n\t//\n\tthis.buttonAlias = {};\n\n\t// Events prefixed with *$* are private, sent from GameeApp ment\n\t// to be handled before resended as *public (non-prefixed)* \n\t// event.\n\t//\n\t// They should be not used in games as they can change in the future.\n\tthis.on('$keydown', function (data) {\n\t\tif (data.button && self.buttonAlias[data.button]) {\n\t\t\tdata.button = self.buttonAlias[data.button];\n\t\t}\n\n\t\tself.trigger('keydown', data);\n\t});\n\n\tthis.on('$keyup', function (data) {\n\t\tif (data.button && self.buttonAlias[data.button]) {\n\t\t\tdata.button = self.buttonAlias[data.button];\n\t\t}\n\n\t\tself.trigger('keyup', data);\n\t});\n\n\t// By default GameeApp will trigger *keydown* and *keyup* events for\n\t// the controller for every button presses/released.\n\t// \n\t// The controller then handles the event and triggers the event for\n\t// the coresponding button.\n\t// \n\t// It expexts a `data` argument which should have a property `button`\n\t// with the name of button.\n\tthis.on('keydown', function (data) {\n\t\tif (!data.button || !self.buttons[data.button]) {\n\t\t\treturn;\n\t\t}\n\n\t\tself.buttons[data.button].trigger('keydown');\n\t});\n\n\tthis.on('keyup', function (data) {\n\t\tif (!data.button || !self.buttons[data.button]) {\n\t\t\treturn;\n\t\t}\n\n\t\tself.buttons[data.button].trigger('keyup');\n\t});\n}\n\nController.prototype = Object.create(BulletClass.constructor.prototype);\nController.constructor = Controller;\n\n/** ### addButton\r\n *\r\n * Add button to the controller.\r\n * \r\n * @param {Button} button a [Button](#button) instance\r\n */\nController.prototype.addButton = function (button) {\n\tthis.buttons[button.key] = button;\n};\n\n/** ### enableKeyboard\r\n * \r\n * Enable keyboard controlls. It will attach event listeners to the \r\n * *window* object for every button and trigger their *keydown* /\r\n * *keyup* event for the controller.\r\n */\nController.prototype.enableKeyboard = function (gamee) {\n\tvar key,\n\t    button,\n\t    keyCodes = {},\n\t    self = this;\n\n\tfor (key in this.buttons) {\n\t\tbutton = this.buttons[key];\n\n\t\tif (button.keyCode) {\n\t\t\tkeyCodes[button.keyCode] = button;\n\t\t}\n\t}\n\n\tgamee._keydown(function (ev) {\n\t\tvar button = keyCodes[ev.keyCode];\n\n\t\tif (!button) {\n\t\t\treturn;\n\t\t}\n\n\t\tev.preventDefault();\n\t\tself.trigger('keydown', { button: button.key });\n\t});\n\n\tgamee._keyup(function (ev) {\n\t\tvar button = keyCodes[ev.keyCode];\n\n\t\tif (!button) {\n\t\t\treturn;\n\t\t}\n\n\t\tev.preventDefault();\n\t\tself.trigger('keyup', { button: button.key });\n\t});\n};\n\n/** ### remapButton\r\n * \r\n * Remap the names of the controller's buttons. Controllers have their\r\n * button names set (left, right, A, B), but sometimes in context of \r\n * the game a different names are desired.\r\n *\r\n * ```javascript\r\n * var controller = gamee.controller.requestController('TwoButtons');\r\n * controller.remapButton('left', 'throttle');\r\n * controller.remapButton('right', 'break');\r\n * \r\n * controller.buttons.throttle.on('keydown', ..);\r\n * ```\r\n *\r\n * @param {String} oldName button name we want to change\r\n * @param {String} newName new button name\r\n */\nController.prototype.remapButton = function (oldName, newName) {\n\n\t// handle old code\n\tif (newName.name) {\n\t\tnewName = newName.name;\n\t}\n\n\tif (this.buttons[oldName]) {\n\t\tthis.buttonAlias[oldName] = newName.name;\n\n\t\tthis.buttons[newName.name] = this.buttons[oldName];\n\n\t\tdelete this.buttons[oldName];\n\t} else {\n\t\tthrow Error('Button ' + oldName + ' was not found in controller');\n\t}\n};\n\n// ## Controllers \n\n/** ### OneButtonController\r\n *\r\n * Controller with only one button.\r\n * @class OneButtonController\r\n */\nfunction OneButtonController() {\n\tController.call(this);\n\n\t// * __name__: 'button' \n\t// * __key__: spacebar\n\tthis.addButton(new Button('button', 32));\n}\nOneButtonController.prototype = Object.create(Controller.prototype);\nOneButtonController.prototype.constructor = OneButtonController;\n\n/** ### TwoButtonController\r\n *\r\n * Controller with two buttons\r\n * @class TwoButtonController\r\n */\nfunction TwoButtonController() {\n\tController.call(this);\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('left', 37));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('right', 39));\n}\nTwoButtonController.prototype = Object.create(Controller.prototype);\nTwoButtonController.prototype.constructor = TwoButtonController;\n\n/** ### TwoActionButtonsController\r\n *\r\n * Controller with two action buttons (A,B)\r\n * @class TwoActionButtonsController\r\n */\nfunction TwoActionButtonsController() {\n\tController.call(this);\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('A', 32));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('B', 17));\n}\nTwoActionButtonsController.prototype = Object.create(Controller.prototype);\nTwoActionButtonsController.prototype.constructor = TwoActionButtonsController;\n\n/** ### FourButtonController\r\n *\r\n * Controller with four buttons\r\n * @class FourButtonController\r\n */\nfunction FourButtonController() {\n\tController.call(this);\n\n\t// * __name__: 'up'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('up', 38));\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('left', 37));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('right', 39));\n\n\t// * __name__: 'A'\n\t// * __key__: spacebar\n\tthis.addButton(new Button('A', 32));\n}\nFourButtonController.prototype = Object.create(Controller.prototype);\nFourButtonController.prototype.constructor = FourButtonController;\n\n/** ### FiveButtonController\r\n *\r\n * Controller with five buttons\r\n * @class FiveButtonController\r\n */\nfunction FiveButtonController() {\n\tController.call(this);\n\n\t// * __name__: 'up'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('up', 38));\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('left', 37));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('right', 39));\n\n\t// * __name__: 'down'\n\t// * __key__: down arrow\n\tthis.addButton(new Button('down', 40));\n\n\t// * __name__: 'A'\n\t// * __key__: spacebar\n\tthis.addButton(new Button('A', 32));\n}\nFiveButtonController.prototype = Object.create(Controller.prototype);\nFiveButtonController.prototype.constructor = FiveButtonController;\n\n/** ### SixButtonController\r\n *\r\n * Controller with six buttons\r\n * @class SixButtonController\r\n */\nfunction SixButtonController() {\n\tController.call(this);\n\n\t// * __name__: 'up'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('up', 38));\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('left', 37));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('right', 39));\n\n\t// * __name__: 'down'\n\t// * __key__: down arrow\n\tthis.addButton(new Button('down', 40));\n\n\t// * __name__: 'A'\n\t// * __key__: spacebar\n\tthis.addButton(new Button('A', 32));\n\n\t// * __name__: 'B'\n\t// * __key__: ctrl\n\tthis.addButton(new Button('B', 17));\n}\nSixButtonController.prototype = Object.create(Controller.prototype);\nSixButtonController.prototype.constructor = SixButtonController;\n\n/** ### TwoArrowsOneButtonController\r\n *\r\n * Controller with two arrows and one action button\r\n * @class TwoArrowsOneButtonController\r\n */\nfunction TwoArrowsOneButtonController() {\n\tController.call(this);\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('left', 37));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('right', 39));\n\n\t// * __name__: 'A'\n\t// * __key__: spacebar\n\tthis.addButton(new Button('A', 32));\n}\nTwoArrowsOneButtonController.prototype = Object.create(Controller.prototype);\nTwoArrowsOneButtonController.prototype.constructor = TwoArrowsOneButtonController;\n\n/** ### TwoArrowsTwoButtonsController\r\n *\r\n * Controller with two arrows and two action buttons\r\n * @class TwoArrowsTwoButtonsController\r\n */\nfunction TwoArrowsTwoButtonsController() {\n\tController.call(this);\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('left', 37));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('right', 39));\n\n\t// * __name__: 'A'\n\t// * __key__: spacebar\n\tthis.addButton(new Button('A', 32));\n\n\t// * __name__: 'B'\n\t// * __key__: ctrl\n\tthis.addButton(new Button('B', 17));\n}\nTwoArrowsTwoButtonsController.prototype = Object.create(Controller.prototype);\nTwoArrowsTwoButtonsController.prototype.constructor = TwoArrowsTwoButtonsController;\n\n/** ### FourArrowController \r\n *\r\n * Controller with four arrow buttons\r\n * @class FourArrowController\r\n */\nfunction FourArrowController() {\n\tController.call(this);\n\n\t// * __name__: 'up'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('up', 38));\n\n\t// * __name__: 'left'\n\t// * __key__: left arrow\n\tthis.addButton(new Button('left', 37));\n\n\t// * __name__: 'right'\n\t// * __key__: righ arrow\n\tthis.addButton(new Button('right', 39));\n\n\t// * __name__: 'down'\n\t// * __key__: down arrow\n\tthis.addButton(new Button('down', 40));\n}\nFourArrowController.prototype = Object.create(Controller.prototype);\nFourArrowController.prototype.constructor = FourArrowController;\n\n/** ### TouchController \r\n *\r\n * This controller has no buttons. Instead it has a touchpad which\r\n * triggers *touchstart*, *touchend*, *touchmove*, *touchcancel*,\r\n * *touchend* events (similar to \r\n * [Touch event types](https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent#Touch_event_types))\r\n *\r\n * The position of the touch is in the `data.position` argument as a \r\n * *x* and *y* with the values between [0, 0] for the left top corner\r\n * and [1, 1] for the bottom right corner ([0.5, 0.5] is the center).\r\n *\r\n * ```javascript\r\n * controller = gamee.controller.requestController('Touch');\r\n *\r\n * controller.on('touchstart', function(data) {\r\n *\tif (data.position.x < 0.5 && data.position.y < 0.5) {\r\n *    console.log('touch in the top left quadrant');\r\n *  }\r\n * })\r\n * ```\r\n * @class TouchController\r\n */\nfunction TouchController() {\n\tvar self = this;\n\n\tController.call(this);\n\n\tthis.on(\"$touchstart\", function (data) {\n\t\tself.trigger('touchstart', data);\n\t});\n\n\tthis.on(\"$touchend\", function (data) {\n\t\tself.trigger('touchend', data);\n\t});\n\n\tthis.on(\"$touchmove\", function (data) {\n\t\tself.trigger('touchmove', data);\n\t});\n\n\tthis.on(\"$touchleave\", function (data) {\n\t\tself.trigger('touchleave', data);\n\t});\n\n\tthis.on(\"$touchcancel\", function (data) {\n\t\tself.trigger('touchcancel', data);\n\t});\n}\nTouchController.prototype = Object.create(TouchController.prototype);\nTouchController.prototype.constructor = TouchController;\n\n/** ### JoystickController \r\n *\r\n * JoystickController emits `change` event, after the position of the \r\n * joystick is changed. \r\n *\r\n * The position of the joystick is in the property `x` and `y`. The \r\n * position on axis is between <-1, 1> (for x -1 is max left \r\n * position, 1 max right position). [0.0, 0.0] is the center.\r\n *\r\n * ```javascript\r\n * joystick = gamee.controller.requestController('Joystick');\r\n *\r\n * joystick.on('change', function() {\r\n *   new_x = joystick.x;\r\n *   nex_y = joystick.y;\r\n * })\r\n * ```\r\n * @class JoystickController\r\n */\nfunction JoystickController() {\n\tvar self = this;\n\n\tController.call(this);\n\n\t// x axis\n\tthis.x = 0;\n\t// y axis\n\tthis.y = 0;\n\n\tthis.on(\"$change\", function (data) {\n\t\tself.x = data.position.x;\n\t\tself.y = data.position.y;\n\n\t\tself.trigger(\"change\", data);\n\t});\n}\nJoystickController.prototype = Object.create(Controller.prototype);\nJoystickController.prototype.constructor = JoystickController;\n\n/** ### JoystickButtonController \r\n *\r\n * JoystickButtonController is a `JoystickController` with one button.\r\n *\r\n * ```javascript\r\n * joystick = gamee.controller.requestController('JoystickWithButton');\r\n *\r\n * joystick.on('change', function() {\r\n *   new_x = joystick.x;\r\n *   nex_y = joystick.y;\r\n * })\r\n *\r\n * joystick.buttons.button.on('keydown', callback)\r\n * // or simply\r\n * joystick.on('keydown', callback)\r\n * ```\r\n * @class JoystickButtonController\r\n */\nfunction JoystickButtonController() {\n\tvar self = this;\n\n\tJoystickController.call(this);\n\n\t// * __name__: 'button' \n\t// * __key__: spacebar\n\tthis.addButton(new Button('button', 32));\n}\nJoystickButtonController.prototype = Object.create(JoystickController.prototype);\nJoystickButtonController.prototype.constructor = JoystickButtonController;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.gamee = undefined;\n\n__webpack_require__(1);\n\nvar _gameeAPI = __webpack_require__(2);\n\nvar _core = __webpack_require__(0);\n\nvar _platform_bridge = __webpack_require__(3);\n\n/**\r\n * Instance of gamee object with API for developers. \r\n * Internal functions becomes private this way\r\n * \r\n * @requires Gamee\r\n */\nvar gamee = exports.gamee = undefined;\n\n/**\r\n * Resolves what platform is being used and make instance of platform API. \r\n * \r\n * @requires PlatformBridge\r\n */\nvar platformBridge = function () {\n\n    var platformBridge,\n        platformType = \"web\";\n\n    // Reslove Gamee enviroment\n    /* current user agent */\n    var userAgent = navigator.userAgent.toLowerCase();\n\n    if (window.parent !== window && /facebook/.test(document.referrer)) {\n        // FB\n        // TODO fb platform\n        platformType = \"fb\";\n    } else if (/iphone|ipod|ipad/.test(userAgent)) {\n        // test ios device\n        // user agent is use to determine current enviroment\n\n        // Test if window with game have a parent (loading in iframe)\n        if (window.self !== window.top) {\n            platformType = \"web\";\n        } else {\n            platformType = \"ios\";\n        }\n    } else if (/gamee\\/[0-9\\.]+$/.test(userAgent)) {\n        // test android app\n        // TODO do you really test android like that?\n        platformType = \"android\";\n    } else if (window.parent) {\n        // TODO doesnt make sence, parent always exists!!\n        platformType = \"web\";\n    } else if (window.parent && window.parent.gameeSimulator) {\n        // TODO doesnt make sence, parent always exist?\n        platformType = \"web\";\n    }\n\n    exports.gamee = gamee = new _gameeAPI.Gamee(platformType);\n\n    switch (platformType) {\n        case \"web\":\n            if (window.parent === window) {\n                console.error(\"Gamee must run in iframe on web platform\");\n            }\n            platformBridge = new _platform_bridge.PostMessageBridge(window.parent);\n            break;\n        case \"ios\":\n            platformBridge = new _platform_bridge.MobileBridge(\"ios\");\n            break;\n        case \"android\":\n            platformBridge = new _platform_bridge.MobileBridge(\"android\");\n            break;\n        case \"fb\":\n            platformBridge = new _platform_bridge.FacebookBridge(\"fb\");\n            break;\n        default:\n            throw \"Can't identify the platform\";\n    }\n    return platformBridge;\n}();\n\n_core.core.PlatformAPI = _platform_bridge.PlatformAPI;\n_core.core.native = platformBridge;\n\n_platform_bridge.PlatformAPI.emitter = gamee.emitter;\n\nfunction loadScript(url, callback) {\n    // Adding the script tag to the head as suggested before\n    var head = document.getElementsByTagName('head')[0];\n    var script = document.createElement('script');\n    script.src = url;\n\n    // Then bind the event to the callback function.\n    // There are several events for cross browser compatibility.\n    script.onreadystatechange = callback;\n    script.onload = callback;\n\n    // Fire the loading\n    head.appendChild(script);\n}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// gamee-js.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 289f0eff965f1c46466f","import * as controllers from \"./game_controllers.js\"\r\n\r\n/**\r\n * @class core\r\n */\r\nexport var core = (function () {\r\n\r\n    // # Gamee.js\r\n    // \r\n    // This file defines and expose a public API for games to communicate\r\n    // with Gamee*.\r\n    //\r\n    // Also it handles some requirements when Gamee is run in an desktop \r\n    // environment.\r\n    //\r\n    // \\* _later in the document Gamee will be referred as GameeApp to not\r\n    // be mistaken for word game_\r\n    //\r\n    // ** _GameeWebApp will refer to Gamee which is running in a desktop \r\n    // browser_\r\n\r\n    /** an empty function */\r\n    var noop = function () { };\r\n\r\n    var cache = {};\r\n\r\n    /** internal variables/constants (uppercase) coupled inside separate object for potential easy referencing */\r\n    var internals = {\r\n        VERSION: \"2.0\", // version of the gamee library\r\n        CAPABILITIES: [\"ghostMode\", \"saveState\", \"replay\", \"socialData\"], // supported capabilities\r\n        variant: 0, // for automating communication with server\r\n        soundUnlocked: false,\r\n        onReady: noop, // for intercepting real onReady because of behind the scenes variant handling\r\n        onGameStart: noop // for intercepting real onGameStart because of unlocking sound\r\n    };\r\n\r\n    /** ## gamee\r\n     *\r\n     * GameeApp interface for games. It is exposed as a `gamee` global\r\n     * object and games should only use its public methods and \r\n     * properties to communicate with the GameeApp. \r\n     *\r\n     * _There is also [$gameeNative](gamee_native.js.html) global object \r\n     * which handles internal parts of the communication._\r\n     */\r\n    var core = {};\r\n\r\n    //\r\n    // ## Signaling game state\r\n    //\r\n    // The game should signal the GameeApp its status (playing/game-over)\r\n    // and current score.\r\n    //\r\n\r\n    /** ### gamee.gameeInit\r\n     *\r\n     * Must be called first before any other gamee calls\r\n     * returns controller object the same way requestController did previously\r\n     * ctrlType/ctrlOpts - requested control type + options\r\n     * capabilities -> array of strings representing supported features:\r\n     * after the initialization onReady is invoked and after that game can use the api\r\n     */\r\n    core.gameeInit = function (ctrlType, ctrlOpts, capabilities, cb) {\r\n        // let's validate the array here, so that all backends can benefit from it\r\n        var allOk = true, cap = {};\r\n        if ((capabilities !== undefined) && (Array.isArray(capabilities))) {\r\n            for (var i = 0; i < capabilities.length; i++) {\r\n                if ((typeof capabilities[i] !== \"string\") ||\r\n                    (internals.CAPABILITIES.indexOf(capabilities[i]) === -1)) allOk = false;\r\n                cap[capabilities[i]] = true;\r\n            }\r\n        } else allOk = false;\r\n\r\n        if (!allOk)\r\n            throw \"Capabilities array passed to gameeInit is void, malformed or unsupported capabilites requested.\";\r\n        // TODO remove\r\n        // gameeNative.gameeInit(core, internals.VERSION, ctrlType, allOk ? capabilities : []);\r\n\r\n        this.native.createRequest(\"init\", {\r\n            version: internals.VERSION,\r\n            controller: ctrlType,\r\n            capabilities: cap\r\n        }, function (responseData) {\r\n            // remember capabilities of the game\r\n            cache.capabilities = cap;\r\n\r\n            // might fail if controller of this type doesnt exist\r\n            var error = null;\r\n            try {\r\n                if (this.native.platform === \"web\" || this.native.platform === \"fb\") {\r\n                    responseData.controller = core.controller.requestController(ctrlType, { enableKeyboard: true });\r\n                    this._bindKeyboardTriggers(responseData.controller);\r\n                } else {\r\n                    responseData.controller = core.controller.requestController(ctrlType, {});\r\n                }\r\n            } catch (err) {\r\n                error = err;\r\n            }\r\n\r\n            cb(error, responseData);\r\n        }.bind(this));\r\n        // TODO remove\r\n        // return core.controller.requestController(ctrlType, ctrlOpts);\r\n    };\r\n\r\n    core._bindKeyboardTriggers = function (controller) {\r\n        global.addEventListener('message', function (ev) {\r\n            switch (ev.data[0]) {\r\n                case 'button_button_down':\r\n                    controller.trigger(\"keydown\", { button: \"button\" });\r\n                    break;\r\n\r\n                case 'button_button_up':\r\n                    controller.trigger(\"keyup\", { button: \"button\" });\r\n                    break;\r\n\r\n                case 'button_left_up':\r\n                    controller.trigger(\"keyup\", { button: \"left\" });\r\n                    break;\r\n\r\n                case 'button_left_down':\r\n                    controller.trigger(\"keydown\", { button: \"left\" });\r\n                    break;\r\n\r\n                case 'button_right_down':\r\n                    controller.trigger(\"keydown\", { button: \"right\" });\r\n                    break;\r\n\r\n                case 'button_right_up':\r\n                    controller.trigger(\"keyup\", { button: \"right\" });\r\n                    break;\r\n\r\n                case 'button_up_down':\r\n                    controller.trigger(\"keydown\", { button: \"up\" });\r\n                    break;\r\n\r\n                case 'button_up_up':\r\n                    controller.trigger(\"keyup\", { button: \"up\" });\r\n                    break;\r\n\r\n                case 'button_down_down':\r\n                    controller.trigger(\"keydown\", { button: \"down\" });\r\n                    break;\r\n\r\n                case 'button_down_up':\r\n                    controller.trigger(\"keyup\", { button: \"down\" });\r\n                    break;\r\n\r\n                case 'button_a_down':\r\n                    controller.trigger(\"keydown\", { button: \"A\" });\r\n                    break;\r\n\r\n                case 'button_a_up':\r\n                    controller.trigger(\"keyup\", { button: \"A\" });\r\n                    break;\r\n\r\n\r\n                case 'button_b_down':\r\n                    controller.trigger(\"keydown\", { button: \"B\" });\r\n                    break;\r\n\r\n                case 'button_b_up':\r\n                    controller.trigger(\"keyup\", { button: \"B\" });\r\n                    break;\r\n            }\r\n        });\r\n    };\r\n\r\n    /** ### gamee.gameLoadingProgress\r\n     *\r\n     * Indicates how much content is already loaded in %.\r\n     */\r\n    core.gameLoadingProgress = (function () {\r\n        var percentageSoFar = 0;\r\n\r\n        return function (percentage) {\r\n            if ((typeof percentage !== \"number\") || (percentage < 0) || (percentage > 100))\r\n                throw \"Percentage passed to gameLoadingProgress out of bounds or not a number.\";\r\n            else if (percentage > percentageSoFar) {\r\n                percentageSoFar = percentage;\r\n                this.native.createRequest(\"gameLoadingProgress\", { percentage: percentage });\r\n            }\r\n        };\r\n    })();\r\n\r\n\r\n    /** ### gamee.gameReady\r\n     *\r\n     * Notifies platform game can accept start command. \r\n     */\r\n    core.gameReady = function () {\r\n        this.native.createRequest(\"gameReady\");\r\n    };\r\n\r\n    /** ### gamee.gameStart\r\n     *\r\n     * Indicates that game is ready to be started (even after restart).\r\n     */\r\n    // core.gameStart = function () {\r\n    //     gameeNative.gameLoadingProgress(100); // FB requires this\r\n    //     gameeNative.gameStart(gamee);\r\n    // };\r\n\r\n    /** ### gamee.updateScore\r\n     *\r\n     * sends score to UI\r\n     */\r\n    core.updateScore = function (score, opt_ghostSign) {\r\n        if (typeof score !== \"number\")\r\n            throw \"Score passed to updateScore is not a number.\";\r\n        var data = {\r\n            score: parseInt(score, 10)\r\n        };\r\n        if (opt_ghostSign) {\r\n            data.ghostSign = true;\r\n        }\r\n        this.native.createRequest(\"updateScore\", data);\r\n        // core.native.createRequest(method, requestData, callback);\r\n    };\r\n\r\n    /** ### gamee.gameOver\r\n     *\r\n     * Indicates the game has ended, the game is waiting for subsequent onGameStart.\r\n     * Data has the same format as data received in onReady callback.\r\n     * Data must be string = responsibility for turning data structure into string is left to the game!\r\n     */\r\n    core.gameOver = function (opt_replayData) {\r\n        // var allOk = ((data !== undefined) && (typeof data === \"string\")) || (data === undefined);\r\n        // if (!allOk) console.error(\"Data provided to gameOver function must be string.\");\r\n        // gameeNative.gameOver(gamee, internals.variant, allOk ? data : \"\");\r\n        var requestData = {};\r\n        if (opt_replayData) {\r\n            if (!opt_replayData.hasOwnProperty(\"variant\")) {\r\n                opt_replayData.variant = \"\";\r\n            }\r\n            if (!opt_replayData.hasOwnProperty(\"data\")) {\r\n                throw \"Replay data must have `data` property\";\r\n            }\r\n            requestData.replayData = opt_replayData;\r\n        }\r\n        core.native.createRequest(\"gameOver\", requestData);\r\n    };\r\n\r\n    /** ### gamee.gameSave\r\n     *\r\n     * Player has requested saving current game's state\r\n     * data must be string = responsibility for turning data structure into string is left to game!\r\n     * share must be expression evaluating to either true or false; it indicates, whether the game progress should be shared on feed\r\n     */\r\n    core.gameSave = function (data, share) {\r\n        var state;\r\n        if (typeof data === \"object\") {\r\n            // gameeNative.gameSave(internals.variant, data, share ? 1 : 0);\r\n            try {\r\n                state = JSON.stringify(data);\r\n            } catch (err) {\r\n                throw \"data provided to gameSave function must be valid JSON: \" + err;\r\n            }\r\n            core.native.createRequest(\"saveState\", { state: state, share: share });\r\n        } else {\r\n            throw \"data provided to gameSave function must be object\";\r\n        }\r\n    };\r\n\r\n    core.requestSocial = function (cb) {\r\n        this.native.createRequest(\"requestSocial\", function (responseData) {\r\n            cb(null, responseData);\r\n        });\r\n    };\r\n\r\n\r\n    core.startSignal = function (data) {\r\n        var error;\r\n\r\n        if (data.replay && !cache.capabilities.replay)\r\n            error = \"Game doesn't support replay. \";\r\n\r\n        if (data.ghostMode && !cache.capabilities.ghostMode)\r\n            error = \"Game doesn't support ghost Mode. \";\r\n\r\n        return error;\r\n    };\r\n    //\r\n    // ## Private objects and methods\r\n    // These are internal objects in closed scope. Good to know about them\r\n    // when debugging.\r\n\r\n    //\r\n    // ## gamee.controller\r\n    //\r\n    // Namespace where the methods for controller are published.\r\n    // \r\n\r\n    /**\r\n     * TODO transform this into instance of gamee class\r\n     */\r\n    core.controller = {\r\n        /** ### mainController\r\n         * \r\n         * Current controller.\r\n         */\r\n        mainController: null,\r\n\r\n        /** ### requestController\r\n         *\r\n         * Factory method to create a controller. It creates the controller\r\n         * and signals to GameeApp which type the game requires\r\n         *\r\n         * You should called this method once before calling\r\n         * `gamee.gameStart()`.\r\n         *\r\n         * @param {String} type type of controller (see [controllerTypes](#controllertypes))\r\n         * @param {Object} [opts] optional controller options \r\n         * {'enableKeyboard': .., 'buttons': ...}\r\n         * @param {boolean} [opts.enableKeyboard] enable the keyboard\r\n         * @param {Object} [opts.buttons] remap buttons {'oldKey': 'newKey', \r\n         * 'left': 'break' ..}\r\n         */\r\n        requestController: function (type, opts) {\r\n            if (type === \"FullScreen\")\r\n                return null;\r\n\r\n            var controller = createController(type, opts);\r\n\r\n            this.mainController = controller;\r\n\r\n            return controller;\r\n        },\r\n\r\n        /** ### additionalController\r\n         * \r\n         * Construct an additional controller. Sometimes games require a\r\n         * different controller depending on platform (eg. touch on mobile, \r\n         e but Four Buttons on desktop)\r\n         *\r\n         * **This is currently supported only for GameeWebApp** as a way to \r\n         * have alternate keybinding. The game should request a type used \r\n         * for mobile platform and then some other as *additionalController*\r\n         * if alternate keybinding is needed;\r\n         */\r\n        // TODO remove this function\r\n        additionalController: function (type, opts) {\r\n            var controller = createController(type, opts);\r\n            gameeNative.additionalController(type);\r\n\r\n            return controller;\r\n        },\r\n\r\n        /** ### trigger\r\n         * \r\n         * Triggers and event for the controller\r\n         *\r\n         * This is called by GameeApp to trigger the *keydown*, *keyup*\r\n         * events. For more info see [Controller](#controller)\r\n         * \r\n         * @param {String} eventName name of the event\r\n         * @param {*} [data,...] data to pass for the event\r\n         *\r\n         */\r\n        trigger: function () {\r\n            var i;\r\n\r\n            if (this.mainController) {\r\n                this.mainController.trigger.apply(this.mainController, arguments);\r\n            } else {\r\n                throw new Error('No controller present');\r\n            }\r\n        }\r\n    };\r\n\r\n\t/** ### core._keydown\r\n\t * \r\n\t * A helper function to listen for `keydown` events on window object.\r\n\t * \r\n\t * @param {Function} fn callback to handle the event\r\n\t */\r\n    core._keydown = function (fn) {\r\n        global.addEventListener('keydown', wrapKeyEvent(fn));\r\n    };\r\n\r\n\t/** ### core._keyup\r\n\t * \r\n\t * A helper function to listen for `keyup` events on window object.\r\n\t * \r\n\t * @param {Function} fn callback to handle the event\r\n\t */\r\n    core._keyup = function (fn) {\r\n        global.addEventListener('keyup', wrapKeyEvent(fn));\r\n    };\r\n\r\n    /** ### createController\r\n     * \r\n     * Function to create a controller.\r\n     *\r\n     * *see [requestController](#requestcontroller)\r\n     *\r\n     * @param {String} type\r\n     * @param {Object} [opts]\r\n     * @returns {Controller} controller\r\n     */\r\n    function createController(type, opts) {\r\n        var btn, controller;\r\n\r\n        if (!controllerTypes[type]) {\r\n            throw new Error('Unsupported controller type, ' + type);\r\n        }\r\n\r\n        opts = opts || {};\r\n\r\n        controller = new controllerTypes[type]();\r\n\r\n        if (opts.enableKeyboard) {\r\n            controller.enableKeyboard(core);\r\n        }\r\n\r\n        if (opts.buttons) {\r\n            for (btn in opts.buttons) {\r\n                controller.remapButton(btn, opts.buttons[btn]);\r\n            }\r\n        }\r\n\r\n        return controller;\r\n    }\r\n\r\n\r\n\r\n    /** ### controllerTypes\r\n     *\r\n     * List of controller types and their coresponding classes.\r\n     *\r\n     * *see [Controllers](#controllers) for more info*\r\n     * @requires Controller\r\n     */\r\n    var controllerTypes = {\r\n        'OneButton': controllers.OneButtonController,\r\n        'TwoButtons': controllers.TwoButtonController,\r\n        'FourButtons': controllers.FourButtonController,\r\n        'FiveButtons': controllers.FiveButtonController,\r\n        'SixButtons': controllers.SixButtonController,\r\n        'FourArrows': controllers.FourArrowController,\r\n        'Touch': controllers.TouchController,\r\n        'Joystick': controllers.JoystickController,\r\n        'JoystickWithButton': controllers.JoystickButtonController,\r\n        'TwoArrowsTwoButtons': controllers.TwoArrowsTwoButtonsController,\r\n        'TwoArrowsOneButton': controllers.TwoArrowsOneButtonController,\r\n        'TwoActionButtons': controllers.TwoActionButtonsController\r\n    };\r\n\r\n\r\n    core.registerPlatform = function (platformAPI) {\r\n        // platformAPI.addEventListener()\r\n        // TODO ?\r\n    };\r\n\r\n    return core;\r\n})();\n\n\n// WEBPACK FOOTER //\n// ./gamee/src/core.js","/**\r\n * @class CustomEvent\r\n */\r\n(function shimCustomEvent() {\r\n\ttry {\r\n\t\tvar ce = new window.CustomEvent('test');\r\n\t\tce.preventDefault();\r\n\t\tif (ce.defaultPrevented !== true) {\r\n\t\t\t// IE has problems with .preventDefault() on custom events\r\n\t\t\t// http://stackoverflow.com/questions/23349191\r\n\t\t\tthrow new Error('Could not prevent default');\r\n\t\t}\r\n\t} catch (e) {\r\n\t\tvar CustomEvent = function (event, params) {\r\n\t\t\tvar evt, origPrevent;\r\n\t\t\tparams = params || {\r\n\t\t\t\tbubbles: false,\r\n\t\t\t\tcancelable: false,\r\n\t\t\t\tdetail: undefined\r\n\t\t\t};\r\n\r\n\t\t\tevt = document.createEvent(\"CustomEvent\");\r\n\t\t\tevt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n\t\t\torigPrevent = evt.preventDefault;\r\n\t\t\tevt.preventDefault = function () {\r\n\t\t\t\torigPrevent.call(this);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tObject.defineProperty(this, 'defaultPrevented', {\r\n\t\t\t\t\t\tget: function () {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tthis.defaultPrevented = true;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn evt;\r\n\t\t};\r\n\r\n\t\tCustomEvent.prototype = window.Event.prototype;\r\n\t\twindow.CustomEvent = CustomEvent; // expose definition to window\r\n\t}\r\n})();\r\n\r\n//addEventListener polyfill 1.0 / Eirik Backer / MIT Licence\r\n(function (win, doc) {\r\n\tif (win.addEventListener) return;\t\t//No need to polyfill\r\n\r\n\tfunction docHijack(p) { var old = doc[p]; doc[p] = function (v) { return addListen(old(v)); }; }\r\n\tfunction addEvent(on, fn, self) {\r\n\t\treturn (self = this).attachEvent('on' + on, function (e) {\r\n\t\t\te = e || win.event;\r\n\t\t\te.preventDefault = e.preventDefault || function () { e.returnValue = false; };\r\n\t\t\te.stopPropagation = e.stopPropagation || function () { e.cancelBubble = true; };\r\n\t\t\tfn.call(self, e);\r\n\t\t});\r\n\t}\r\n\tfunction addListen(obj, i) {\r\n\t\ti = obj.length;\r\n\t\tif (i) {\r\n\t\t\twhile (i--)\r\n\t\t\t\tobj[i].addEventListener = addEvent;\r\n\t\t} else {\r\n\t\t\tobj.addEventListener = addEvent;\r\n\t\t}\r\n\t\treturn obj;\r\n\t}\r\n\r\n\taddListen([doc, win]);\r\n\tif ('Element' in win) win.Element.prototype.addEventListener = addEvent;\t\t\t//IE8\r\n\telse {\t\t//IE < 8\r\n\t\tdoc.attachEvent('onreadystatechange', function () { addListen(doc.all); });\t\t//Make sure we also init at domReady\r\n\t\tdocHijack('getElementsByTagName');\r\n\t\tdocHijack('getElementById');\r\n\t\tdocHijack('createElement');\r\n\t\taddListen(doc.all);\r\n\t}\r\n})(window, document);\r\n\r\n// naomik event emiter http://stackoverflow.com/a/24216547/1866147\r\n// usage:\r\n// function Example() {\r\n// \tCustomEmitter.call(this);\r\n// }\r\n\r\n// // run it\r\n// var e = new Example();\r\n\r\n// e.addEventListener(\"something\", function (event) {\r\n// \tconsole.log(event)\r\n// });\r\n\r\n// e.dispatchEvent(new Event(\"something\"));\r\nexport function CustomEmitter() {\r\n\tvar eventTarget = document.createDocumentFragment();\r\n\r\n\tfunction delegate(method) {\r\n\t\tthis[method] = eventTarget[method].bind(eventTarget);\r\n\t}\r\n\r\n\t[\r\n\t\t\"addEventListener\",\r\n\t\t\"dispatchEvent\",\r\n\t\t\"removeEventListener\"\r\n\t].forEach(delegate, this);\r\n}\r\n\r\n/** ### wrapKeyEvent \r\n * \r\n * Handle old IE event differences for key events\r\n * \r\n * @param {Function} fn callback\r\n */\r\nexport function wrapKeyEvent(fn) {\r\n\treturn function (ev) {\r\n\t\tif (!ev || !ev.keyCode) {\r\n\t\t\tif (!ev) {\r\n\t\t\t\tev = window.event;\r\n\t\t\t}\r\n\r\n\t\t\tif (ev.which) {\r\n\t\t\t\tev.keyCode = ev.which;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn fn(ev);\r\n\t};\r\n}\n\n\n// WEBPACK FOOTER //\n// ./gamee/libs/shims.js","import { core } from \"./core.js\"\r\nimport { CustomEmitter } from \"../libs/shims.js\"\r\n\r\n/**\r\n * gameeAPI module desc\r\n * @module gameeAPI\r\n */\r\n\r\n/**\r\n * Emit events\r\n * @class GameeEmitter\r\n * @extends CustomEmitter\r\n */\r\nexport var GameeEmitter = function () {\r\n    CustomEmitter.call(this);\r\n};\r\n\r\n/**\r\n * @class Gamee\r\n * @requires core\r\n * \r\n */\r\nexport var Gamee = function (platform) {\r\n    /**\r\n     * @instance\r\n     * \r\n     * @fires gameeAPI:GameeEmitter~start\r\n     * @fires gameeAPI:GameeEmitter~mute\r\n     * @fires gameeAPI:GameeEmitter~unmute\r\n     * @fires gameeAPI:GameeEmitter~pause\r\n     * @fires gameeAPI:GameeEmitter~unpause\r\n     * @fires gameeAPI:GameeEmitter~ghostHide\r\n     * @fires gameeAPI:GameeEmitter~ghostShow\r\n     */\r\n    this.emitter = new GameeEmitter();\r\n    this._platform = platform;\r\n};\r\n\r\nGamee.prototype = (function () {\r\n\r\n    var cbError = function (err) {\r\n        if (err) {\r\n            throw \"Error \" + err.toString();\r\n        }\r\n    };\r\n\r\n    return {\r\n        _controller: core.controller,\r\n        /**\r\n         * gameInit\r\n         * @memberof Gamee\r\n         * @param {string} controllType\r\n         * @param {object} controllOpts\r\n         * @param {string[]} capabilites\r\n         * @param {gameInitCallback} cb \r\n         */\r\n        gameInit: function (controllType, controllOpts, capabilities, cb) {\r\n            var result = core.gameeInit(controllType, controllOpts, capabilities, cb);\r\n            // cb(null, result);\r\n        },\r\n\r\n        /**\r\n         * gameLoadingProgress\r\n         * \r\n         * NOTE: There are 2 signatures for this function\r\n         * \r\n         *     gamee.gameLoadingProgress()\r\n         * \r\n         * @memberof Gamee\r\n         * @param {number} percentage current loading progress\r\n         * @param {Gamee~voidCallback} [opt_cb] \r\n         * \r\n         */\r\n        gameLoadingProgress: function (percentage, opt_cb) {\r\n            opt_cb = opt_cb || cbError;\r\n            core.gameLoadingProgress(percentage);\r\n            opt_cb(null);\r\n        },\r\n\r\n        /**\r\n         * gameReady\r\n         * \r\n         * @memberof Gamee\r\n         * @param {Gamee~voidCallback} [opt_cb] \r\n         */\r\n        gameReady: function (opt_cb) {\r\n            opt_cb = opt_cb || cbError;\r\n            core.gameReady();\r\n            opt_cb(null);\r\n        },\r\n\r\n        /**\r\n         * gameSave\r\n         * \r\n         * NOTE: There are 2 signatures for this function\r\n         * \r\n         *     gamee.gameSave(data, opt_cb)\r\n         *     gamee.gameSave(data, opt_share, opt_cb)\r\n         * \r\n         * @memberof Gamee\r\n         * @param {object} data current loading progress\r\n         * @param {boolean} [opt_share=false] \r\n         * @param {Gamee~voidCallback} [opt_cb] \r\n         * \r\n         */\r\n        gameSave: function (data, opt_share, opt_cb) {\r\n            var share = false, cb;\r\n            if (typeof opt_share === 'undefined')\r\n                cb = cbError;\r\n            else if (typeof opt_share === 'function')\r\n                cb = opt_share;\r\n            else if (typeof opt_share === 'boolean') {\r\n                share = opt_share;\r\n                cb = opt_cb || cbError;\r\n            }\r\n            core.gameSave(data, share);\r\n            cb(null);\r\n        },\r\n\r\n        /**\r\n         * getPlatform\r\n         * \r\n         * @memberof Gamee\r\n         * @returns {string} platform type can be android | ios | web | fb\r\n         */\r\n        getPlatform: function () {\r\n            return this._platform;\r\n        },\r\n\r\n        /**\r\n         * updateScore\r\n         * \r\n         * @memberof Gamee\r\n         * @param {number} score\r\n         * @param {boolean} [opt_ghostSign=false] If true, score will be updated for ghost instead. \r\n         * @param {Gamee~voidCallback} [opt_cb] \r\n         */\r\n        updateScore: function (score, opt_ghostSign, opt_cb) {\r\n            if (typeof opt_ghostSign === \"function\") {\r\n                opt_cb = opt_ghostSign;\r\n                opt_ghostSign = undefined;\r\n            }\r\n            opt_cb = opt_cb || cbError;\r\n            core.updateScore(score, opt_ghostSign);\r\n            opt_cb(null);\r\n        },\r\n\r\n        /**\r\n         * gameOver\r\n         * \r\n         * @memberof Gamee\r\n         * @param {Gamee~ReplayData} [opt_replayData]\r\n         * @param {Gamee~voidCallback} [opt_cb] \r\n         */\r\n        gameOver: function (opt_replayData, opt_cb) {\r\n            if (typeof opt_replayData === \"function\") {\r\n                opt_cb = opt_replayData;\r\n                opt_replayData = undefined;\r\n            }\r\n            opt_cb = opt_cb || cbError;\r\n            core.gameOver(opt_replayData);\r\n            opt_cb(null);\r\n        },\r\n\r\n        /**\r\n         * requestSocialData\r\n         * \r\n         * @memberof Gamee\r\n         * @param {Gamee~requestSocialDataCallback} cb \r\n         */\r\n        requestSocial: function (cb) {\r\n            var data = core.requestSocial(cb);\r\n            //cb(null, data);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @typedef ReplayData\r\n     * @param {string} variant\r\n     * @param {string} data\r\n     */\r\n\r\n    /**\r\n     * This callback is displayed as part of the Requester class.\r\n     * @callback Gamee~voidCallback\r\n     * @param {string} responseCode\r\n     */\r\n\r\n    /**\r\n     * This callback is displayed as part of the Requester class.\r\n     * @callback Gamee~gameInitCallback\r\n     * @param {object} data\r\n     * @param {string} responseCode\r\n     */\r\n\r\n    /**\r\n     * This callback is displayed as part of the Requester class.\r\n     * @callback Gamee~requestSocialDataCallback\r\n     * @param {object} data\r\n     * @param {string} responseCode\r\n     */\r\n\r\n})();\r\n\r\n/**\r\n * Signals that game should start as normal|replay|ghost game. \r\n * Signal means there is no overlay over the game. \r\n * This signal is also being used for game restart. If previous \r\n * instance of the game was running, it should be terminated without\r\n * any additional calls and current progress should be tossed. \r\n * @event gameeAPI:GameeEmitter~start\r\n * @type {object}\r\n * @property {EventDetailStart} detail - Common property of events\r\n */\r\n\r\n/**\r\n * Data carried with start event. \r\n * @typedef EventDetailStart\r\n * @property {Gamee~voidCallback} callback - called after finishing task\r\n * @property {boolean} [opt_resetState=false] - if true, game must delete current progress and saved progress\r\n * @property {boolean} [opt_replay] - if true, game must run in replay mode\r\n * @property {boolean} [opt_ghostMode] - if true, game must run in ghost mode\r\n */\r\n\r\n/**\r\n * After that signal, game must silent all sounds immediately. \r\n * Game must remain silent until unmute signal occures. \r\n * @event gameeAPI:GameeEmitter~mute\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\r\n\r\n/**\r\n * After unmute signal, game can play sounds again. \r\n * @event gameeAPI:GameeEmitter~unmute\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\r\n\r\n/**\r\n * Pause signal means there appeared overlay over the game. Player\r\n * is unable to reach the context of the game anymore. So game should\r\n * pause all its acctions immediately. \r\n * @event gameeAPI:GameeEmitter~pause\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\r\n\r\n/**\r\n * Unpause signal means there is no overlay over the game anymore. \r\n * Game should continue with all previous actions. \r\n * @event gameeAPI:GameeEmitter~unpause\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\r\n\r\n/**\r\n * Signal ghostHide can appear only if game is running in ghost mode.\r\n * Game should hide ghost behavior and look like exactly as game without \r\n * the ghost (if this is possible). \r\n * @event gameeAPI:GameeEmitter~ghostHide\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\r\n\r\n/**\r\n * Signal ghostShow can appear only if game is running in ghost mode. \r\n * Game should show ghost again if it was hidden. If ghost died or ended\r\n * while it was hidden, game should point that out, so the player can understand\r\n * why the ghost is not visible anymore.  \r\n * @event gameeAPI:GameeEmitter~ghostShow\r\n * @type {object}\r\n * @property {EventDetailVoid} detail - Common property of events\r\n */\r\n\r\n/**\r\n * Data carried with various events. Contains only callback method. \r\n * @typedef {object} EventDetailVoid\r\n * @property {Gamee~voidCallback} callback - call after finishing task\r\n */\r\n\r\n/**\r\n * @type {function}\r\n * @param {MyEvent} e - The observable event.\r\n * @listens gameeAPI:GameeEmitter~event:snowball\r\n */\n\n\n// WEBPACK FOOTER //\n// ./gamee/src/gameeAPI.js","import { core } from \"./core.js\"\r\n\r\n/**\r\n * \r\n * @requires core\r\n * \r\n * @typedef PlatformAPI\r\n * @param {EventTarget} emitter\r\n * @param {function} _pause\r\n * @param {function} _resume\r\n * @param {function} _ghostShow\r\n * @param {function} _ghostHide\r\n * @param {function} _mute\r\n * @param {function} _unmute\r\n * @param {function} _start\r\n */\r\nexport var PlatformAPI = {\r\n\temitter: null,\r\n\tpause: function (cb) {\r\n\t\tvar event = new CustomEvent('pause', {\r\n\t\t\tdetail: {\r\n\t\t\t\tcallback: cb\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.emitter.dispatchEvent(event);\r\n\t},\r\n\tresume: function (cb) {\r\n\t\tvar event = new CustomEvent('resume', {\r\n\t\t\tdetail: {\r\n\t\t\t\tcallback: cb\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.emitter.dispatchEvent(event);\r\n\t},\r\n\tghostShow: function (cb) {\r\n\t\tvar event = new CustomEvent('ghostShow', {\r\n\t\t\tdetail: {\r\n\t\t\t\tcallback: cb\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.emitter.dispatchEvent(event);\r\n\t},\r\n\tghostHide: function (cb) {\r\n\t\tvar event = new CustomEvent('ghostHide', {\r\n\t\t\tdetail: {\r\n\t\t\t\tcallback: cb\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.emitter.dispatchEvent(event);\r\n\t},\r\n\tmute: function (cb) {\r\n\t\tvar event = new CustomEvent('mute', {\r\n\t\t\tdetail: {\r\n\t\t\t\tcallback: cb\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.emitter.dispatchEvent(event);\r\n\t},\r\n\tunmute: function (cb) {\r\n\t\tvar event = new CustomEvent('unmute', {\r\n\t\t\tdetail: {\r\n\t\t\t\tcallback: cb\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.emitter.dispatchEvent(event);\r\n\t},\r\n\tstart: function (data, cb) {\r\n\t\tvar event = new CustomEvent('start', {\r\n\t\t\tdetail: {\r\n\t\t\t\tcallback: cb\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar error = core.startSignal(data);\r\n\t\tif (error) {\r\n\t\t\tcb(error);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (data.replay)\r\n\t\t\tevent.detail.opt_replay = true;\r\n\t\tif (data.ghostMode)\r\n\t\t\tevent.detail.opt_ghostMode = true;\r\n\t\tif (data.resetState)\r\n\t\t\tevent.detail.opt_resetState = true;\r\n\r\n\t\tthis.emitter.dispatchEvent(event);\r\n\t}\r\n};\r\n\r\n\r\n/**\r\n * @class PlatformBridge\r\n * \r\n */\r\nexport function PlatformBridge() {\r\n\tthis.requests = {};\r\n\tthis.platform = \"\";\r\n\tthis._init();\r\n}\r\n\r\nPlatformBridge.prototype = {\r\n\tinstCount: 0,\r\n\t_init: function () {\r\n\t},\r\n\tcreateRequest: function (method, opt_requestData, opt_callback) {\r\n\t\tif (!this.validateMethod(method))\r\n\t\t\treturn;\r\n\t\tif (typeof opt_requestData === 'function') {\r\n\t\t\topt_callback = opt_requestData;\r\n\t\t\topt_requestData = undefined;\r\n\t\t}\r\n\r\n\t\tvar messId = this.instCount++;\r\n\r\n\t\tif (typeof opt_callback !== 'undefined') {\r\n\t\t\tthis.requests[messId] = opt_callback;\r\n\t\t}\r\n\r\n\t\tvar preparedObject = {\r\n\t\t\trequest: {\r\n\t\t\t\tmethod: method,\r\n\t\t\t\tmessageId: messId,\r\n\t\t\t\tdata: null\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.doCall(preparedObject, opt_requestData);\r\n\t},\r\n\tvalidateMethod: function (method) {\r\n\t\treturn method === \"gameLoadingProgress\" ? false : true;\r\n\t},\r\n\t/**\r\n\t * @abstract\r\n\t */\r\n\tdoCall: function (preparedObject, requestData) {\r\n\t\tthrow \"Not implemented\";\r\n\t},\r\n\t_callback: function (id, responseData) {\r\n\t\tvar cb = this.requests[id];\r\n\t\tdelete this.requests[id];\r\n\t\tif (cb)\r\n\t\t\tcb(responseData);\r\n\t},\r\n\t/**\r\n\t * @abstract\r\n\t */\r\n\tdoResponse: function (preparedObject, responseData) {\r\n\t\tthrow \"Not implemented\";\r\n\t},\r\n};\r\n\r\n\r\n/**\r\n * @class PostMessageBridge\r\n * @requires PlatformBridge\r\n */\r\nexport function PostMessageBridge(endpoint) {\r\n\tthis._gameeWin = endpoint;\r\n\tPlatformBridge.call(this);\r\n\tthis.platform = \"web\";\r\n}\r\n\r\nPostMessageBridge.prototype = Object.create(PlatformBridge.prototype);\r\nPostMessageBridge.prototype.constructor = PostMessageBridge;\r\n\r\nPostMessageBridge.prototype._init = function () {\r\n\r\n\twindow.addEventListener('message', function (ev) {\r\n\t\t// if(ev.origin === \"source we want\")\r\n\t\t// console.log(\"_triggerMessage detail: \" + ev.detail);\r\n\t\t// console.log(\"_triggerMessage data: \" + ev.data);\r\n\t\tvar data;\r\n\t\tif (typeof ev.detail === \"object\" && typeof ev.detail !== null) {\r\n\t\t\tdata = ev.detail;\r\n\t\t} else if (typeof ev.data === \"object\") {\r\n\t\t\tdata = ev.data;\r\n\t\t} else {\r\n\t\t\t// message is not from native platform\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// this is request\r\n\t\tif (data.request && data.request.method && typeof data.request.messageId !== \"undefined\") {\r\n\t\t\tthis._resolveAPICall(data.request.method, data.request.messageId, data.request.data);\r\n\t\t}\r\n\t\t// this is reponse\r\n\t\telse if (data.response && typeof data.response.messageId !== \"undefined\") {\r\n\t\t\tif (data.error)\r\n\t\t\t\tthrow data.error;\r\n\t\t\tthis._callback(data.response.messageId, data.response.data);\r\n\t\t}\r\n\t\t// else this message target is not this framework\r\n\t}.bind(this), false);\r\n};\r\n\r\n\r\nPostMessageBridge.prototype.doCall = function (preparedObject, requestData) {\r\n\tif (typeof requestData === \"object\") {\r\n\t\tpreparedObject.request.data = requestData || {};\r\n\t}\r\n\tthis._gameeWin.postMessage(preparedObject, \"*\");\r\n};\r\n\r\nPostMessageBridge.prototype.doResponse = function (messageId, responseData) {\r\n\tvar preparedObject = {\r\n\t\tversion: this.version,\r\n\t\tresponse: {\r\n\t\t\tmessageId: messageId\r\n\t\t}\r\n\t};\r\n\r\n\tif (responseData)\r\n\t\tpreparedObject.data = responseData;\r\n\r\n\tthis._gameeWin.postMessage(preparedObject, \"*\");\r\n};\r\n\r\nPostMessageBridge.prototype._resolveAPICall = function (method, messageId, opt_data) {\r\n\tvar cb = this.doResponse.bind(this, messageId);\r\n\r\n\tswitch (method) {\r\n\t\tcase \"pause\":\r\n\t\t\tPlatformAPI.pause(cb);\r\n\t\t\tbreak;\r\n\t\tcase \"resume\":\r\n\t\t\tPlatformAPI.resume(cb);\r\n\t\t\tbreak;\r\n\t\tcase \"mute\":\r\n\t\t\tPlatformAPI.mute(cb);\r\n\t\t\tbreak;\r\n\t\tcase \"unmute\":\r\n\t\t\tPlatformAPI.unmute(cb);\r\n\t\t\tbreak;\r\n\t\tcase \"ghostShow\":\r\n\t\t\tPlatformAPI.ghostShow(cb);\r\n\t\t\tbreak;\r\n\t\tcase \"ghostHide\":\r\n\t\t\tPlatformAPI.ghostHide(cb);\r\n\t\t\tbreak;\r\n\t\tcase \"start\":\r\n\t\t\tif (!opt_data) {\r\n\t\t\t\tthrow \"Method _start missing params\";\r\n\t\t\t}\r\n\t\t\tPlatformAPI.start(opt_data, cb);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tconsole.error(\"Unknown method call\");\r\n\t}\r\n};\r\n\r\n\r\n/**\r\n * @class MobileBridge\r\n * @requires PlatformBridge\r\n * \r\n */\r\nexport function MobileBridge(device) {\r\n\tthis.device = device;\r\n\tPostMessageBridge.call(this);\r\n\tthis.platform = \"mobile\";\r\n}\r\n\r\nMobileBridge.prototype = Object.create(PostMessageBridge.prototype);\r\nMobileBridge.prototype.constructor = MobileBridge;\r\n\r\nMobileBridge.prototype._init = function () {\r\n\tPostMessageBridge.prototype._init.call(this);\r\n\tif (this.device === \"ios\") {\r\n\t\tthis._gameeWin = webkit.messageHandlers.callbackHandler;\r\n\t} else if (this.device === \"android\") {\r\n\t\tthis._gameeWin = _toDevice;\r\n\t} else {\r\n\t\tthrow \"Unknown device used in webkit bridge\";\r\n\t}\r\n\r\n\twindow._triggerMessage = function (data) {\r\n\t\ttry {\r\n\t\t\tdata = JSON.parse(data); // message is custom message from IOS/android platform\r\n\t\t} catch (err) {\r\n\t\t\tthrow \"Couldn't parse message from native app: \\n\" + data + \"\\n\" + err;\r\n\t\t}\r\n\t\tthis.dispatchEvent(new CustomEvent(\"message\", { detail: data }));\r\n\t};\r\n\r\n};\r\n\r\nMobileBridge.prototype.doCall = function (preparedObject, requestData) {\r\n\tif (typeof requestData === \"object\") {\r\n\t\tpreparedObject.request.data = requestData || {};\r\n\t}\r\n\r\n\tif (this.device === \"android\") // stringify data for android devices, but not for ios\r\n\t\tpreparedObject = JSON.stringify(preparedObject);\r\n\r\n\tthis._gameeWin.postMessage(preparedObject, \"*\");\r\n};\r\n\r\n/**\r\n * @class FacebookBridge\r\n * @requires PlatformBridge\r\n */\r\nexport function FacebookBridge() {\r\n\tPlatformBridge.call(this);\r\n\tthis.platform = \"fb\";\r\n}\r\n\r\nFacebookBridge.prototype = Object.create(PlatformBridge.prototype);\r\nFacebookBridge.prototype.constructor = FacebookBridge;\r\n\r\nFacebookBridge.prototype._init = function () {\r\n};\r\n\r\nFacebookBridge.prototype.createRequest = function (method, opt_requestData, opt_callback) {\r\n\tif (typeof opt_requestData === 'function') {\r\n\t\topt_callback = opt_requestData;\r\n\t\topt_requestData = undefined;\r\n\t}\r\n\r\n\ttry {\r\n\t\tthis._methods[method](opt_callback, opt_requestData);\r\n\t} catch (err) {\r\n\t\tthrow err;\r\n\t}\r\n};\r\n\r\nFacebookBridge.prototype.validateMethod = function (method) {\r\n\treturn true;\r\n};\r\n\r\nFacebookBridge.prototype._methods = {\r\n\tinit: function (cb, data) {\r\n\t\tvar scripts = \"https://connect.facebook.net/en_US/fbinstant.2.1.js\"; // TODO?\r\n\t\tloadScript(scripts, function () {\r\n\t\t\tFBInstant.initializeAsync().then(function (v) {\r\n\t\t\t\tFBInstant.player.getDataAsync(['gamee']).then(function (data) {\r\n\t\t\t\t\tvar saveState = data.gamee || null;\r\n\t\t\t\t\tcb({\r\n\t\t\t\t\t\tsaveState: saveState,\r\n\t\t\t\t\t\treplayData: null,\r\n\t\t\t\t\t\tsound: true\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t}, function (e) {\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\tgameLoadingProgress: function (cb, data) {\r\n\t\tFBInstant.setLoadingProgress(data.percentage);\r\n\t},\r\n\tgameReady: function () {\r\n\t\tFBInstant.setLoadingProgress(100);\r\n\t\tFBInstant.startGameAsync().then(function () {\r\n\t\t\tPlatformAPI.start({}, function () { });\r\n\t\t});\r\n\t},\r\n\tupdateScore: function (cb, data) {\r\n\t\tFBInstant.setScore(data.score);\r\n\t},\r\n\tgameOver: function () {\r\n\t\tFBInstant.endGameAsync().then(function () {\r\n\t\t\tPlatformAPI.start({}, function () { });\r\n\t\t});\r\n\t},\r\n\tsaveState: function (cb, data) {\r\n\t\tFBInstant.player.setDataAsync({\r\n\t\t\t\"gamee\": data.state\r\n\t\t}).then(function () {\r\n\t\t\tconsole.log('FB: data is saved');\r\n\t\t});\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./gamee/src/platform_bridge.js","\r\nvar BulletClass = function () {\r\n    var _self = this,\r\n        _events = {};\r\n\r\n    _self.on = function (event, fn, once) {\r\n        if (arguments.length < 2 ||\r\n            typeof event !== \"string\" ||\r\n            typeof fn !== \"function\") return;\r\n\r\n        var fnString = fn.toString();\r\n\r\n        // if the named event object already exists in the dictionary...\r\n        if (typeof _events[event] !== \"undefined\") {\r\n            // add a callback object to the named event object if one doesn't already exist.\r\n            if (typeof _events[event].callbacks[fnString] === \"undefined\") {\r\n                _events[event].callbacks[fnString] = {\r\n                    cb: fn,\r\n                    once: !!once\r\n                };\r\n            }\r\n            else if (typeof once === \"boolean\") {\r\n                // the function already exists, so update it's 'once' value.\r\n                _events[event].callbacks[fnString].once = once;\r\n            }\r\n        }\r\n        else {\r\n            // create a new event object in the dictionary with the specified name and callback.\r\n            _events[event] = {\r\n                callbacks: {}\r\n            };\r\n\r\n            _events[event].callbacks[fnString] = { cb: fn, once: !!once };\r\n        }\r\n    };\r\n\r\n    _self.once = function (event, fn) {\r\n        _self.on(event, fn, true);\r\n    };\r\n\r\n    _self.off = function (event, fn) {\r\n        if (typeof event !== \"string\" ||\r\n            typeof _events[event] === \"undefined\") return;\r\n\r\n        // remove just the function, if passed as a parameter and in the dictionary.\r\n        if (typeof fn === \"function\") {\r\n            var fnString = fn.toString(),\r\n                fnToRemove = _events[event].callbacks[fnString];\r\n\r\n            if (typeof fnToRemove !== \"undefined\") {\r\n                // delete the callback object from the dictionary.\r\n                delete _events[event].callbacks[fnString];\r\n            }\r\n        }\r\n        else {\r\n            // delete all functions in the dictionary that are\r\n            // registered to this event by deleting the named event object.\r\n            delete _events[event];\r\n        }\r\n    };\r\n\r\n    _self.trigger = function (event, data) {\r\n        if (typeof event !== \"string\" ||\r\n            typeof _events[event] === \"undefined\") return;\r\n\r\n        for (var fnString in _events[event].callbacks) {\r\n            var callbackObject = _events[event].callbacks[fnString];\r\n\r\n            if (typeof callbackObject.cb === \"function\") callbackObject.cb(data);\r\n            if (typeof callbackObject.once === \"boolean\" && callbackObject.once === true) _self.off(event, callbackObject.cb);\r\n        }\r\n    };\r\n\r\n};\r\n\r\n\r\nexport var Bullet = new BulletClass();\n\n\n// WEBPACK FOOTER //\n// ./gamee/libs/bullet.js","import { Bullet } from \"../libs/bullet.js\"\r\n\r\n/**\r\n * @module game_controllers\r\n */\r\n\r\n/** ## Bullet \r\n *\r\n * [Bullet.js](https://github.com/munkychop/bullet) is used as pub/sub\r\n * library. \r\n * \r\n * The controller and its buttons are instance of Bullet.\r\n */\r\nexport var BulletClass = Bullet.constructor;\r\n\r\n\r\n/** ## Button\r\n *\r\n * Represenation of a controller button. It is a child of \r\n * [Bullet](https://github.com/munkychop/bullet), so you can\r\n * subscribe for events triggered on it. \r\n * \r\n * @class Button\r\n * @param {String} key name of the button\r\n * @param {Number} keyCode keycode for the key to represent the button\r\n * on keyboard\r\n */\r\nexport function Button(key, keyCode) {\r\n\tvar self = this;\r\n\r\n\tBulletClass.call(this);\r\n\r\n\tthis._pressed = true;\r\n\r\n\tthis.key = key;\r\n\tthis.keyCode = keyCode;\r\n\r\n\tthis.on('keydown', function () {\r\n\t\tself._pressed = true;\r\n\t});\r\n\r\n\tthis.on('keyup', function () {\r\n\t\tself._pressed = false;\r\n\t});\r\n}\r\n\r\nButton.prototype = Object.create(BulletClass.constructor.prototype);\r\nButton.constructor = Button;\r\n\r\n/** ### isDown\r\n * \r\n * Ask if the button is currently pressed.\r\n *\r\n * @return {Boolean} true if the button is currently pressed\r\n */\r\nButton.prototype.isDown = function () {\r\n\treturn this._pressed;\r\n};\r\n\r\n/** ## Controller\r\n * \r\n * Controller has a collection of [buttons](#buttons).\r\n * It is a child of \r\n * [Bullet](https://github.com/munkychop/bullet), so you can \r\n * subscribe for events triggered on it. \r\n *\r\n * Controllers will get all the events for its buttons so you can\r\n * listen for them globaly from controller or individualy on every\r\n * button.\r\n *\r\n * ```javascript\r\n * controller.on('keydown', function(data) {\r\n *   console.log('button ' + data.button + ' is pressed');\r\n * });\r\n *\r\n * controller.buttons.left.on('keydown', function() {\r\n *   console.log('button left is pressed');\r\n * });\r\n * ```\r\n * \r\n * @class Controller\r\n */\r\nexport function Controller() {\r\n\tvar self = this;\r\n\r\n\tBulletClass.call(this);\r\n\r\n\t// ### buttons\r\n\t//\r\n\t// Map of controller's [buttons](#button) by their name.\r\n\t//\r\n\t// ```javascript\r\n\t// controller.buttons.left // Button('left', ..)\r\n\t// ```\r\n\tthis.buttons = {};\r\n\r\n\t// ### buttonAlias\r\n\t//\r\n\t// Map of remapped buttons.\r\n\t//\r\n\t// *see [remapButton](#remapbutton) for more info*\r\n\t//\r\n\tthis.buttonAlias = {};\r\n\r\n\t// Events prefixed with *$* are private, sent from GameeApp ment\r\n\t// to be handled before resended as *public (non-prefixed)* \r\n\t// event.\r\n\t//\r\n\t// They should be not used in games as they can change in the future.\r\n\tthis.on('$keydown', function (data) {\r\n\t\tif (data.button && self.buttonAlias[data.button]) {\r\n\t\t\tdata.button = self.buttonAlias[data.button];\r\n\t\t}\r\n\r\n\t\tself.trigger('keydown', data);\r\n\t});\r\n\r\n\tthis.on('$keyup', function (data) {\r\n\t\tif (data.button && self.buttonAlias[data.button]) {\r\n\t\t\tdata.button = self.buttonAlias[data.button];\r\n\t\t}\r\n\r\n\t\tself.trigger('keyup', data);\r\n\t});\r\n\r\n\t// By default GameeApp will trigger *keydown* and *keyup* events for\r\n\t// the controller for every button presses/released.\r\n\t// \r\n\t// The controller then handles the event and triggers the event for\r\n\t// the coresponding button.\r\n\t// \r\n\t// It expexts a `data` argument which should have a property `button`\r\n\t// with the name of button.\r\n\tthis.on('keydown', function (data) {\r\n\t\tif (!data.button || !self.buttons[data.button]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tself.buttons[data.button].trigger('keydown');\r\n\t});\r\n\r\n\tthis.on('keyup', function (data) {\r\n\t\tif (!data.button || !self.buttons[data.button]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tself.buttons[data.button].trigger('keyup');\r\n\t});\r\n}\r\n\r\nController.prototype = Object.create(BulletClass.constructor.prototype);\r\nController.constructor = Controller;\r\n\r\n/** ### addButton\r\n *\r\n * Add button to the controller.\r\n * \r\n * @param {Button} button a [Button](#button) instance\r\n */\r\nController.prototype.addButton = function (button) {\r\n\tthis.buttons[button.key] = button;\r\n};\r\n\r\n/** ### enableKeyboard\r\n * \r\n * Enable keyboard controlls. It will attach event listeners to the \r\n * *window* object for every button and trigger their *keydown* /\r\n * *keyup* event for the controller.\r\n */\r\nController.prototype.enableKeyboard = function (gamee) {\r\n\tvar key, button, keyCodes = {}, self = this;\r\n\r\n\tfor (key in this.buttons) {\r\n\t\tbutton = this.buttons[key];\r\n\r\n\t\tif (button.keyCode) {\r\n\t\t\tkeyCodes[button.keyCode] = button;\r\n\t\t}\r\n\t}\r\n\r\n\tgamee._keydown(function (ev) {\r\n\t\tvar button = keyCodes[ev.keyCode];\r\n\r\n\t\tif (!button) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tev.preventDefault();\r\n\t\tself.trigger('keydown', { button: button.key });\r\n\t});\r\n\r\n\tgamee._keyup(function (ev) {\r\n\t\tvar button = keyCodes[ev.keyCode];\r\n\r\n\t\tif (!button) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tev.preventDefault();\r\n\t\tself.trigger('keyup', { button: button.key });\r\n\t});\r\n};\r\n\r\n/** ### remapButton\r\n * \r\n * Remap the names of the controller's buttons. Controllers have their\r\n * button names set (left, right, A, B), but sometimes in context of \r\n * the game a different names are desired.\r\n *\r\n * ```javascript\r\n * var controller = gamee.controller.requestController('TwoButtons');\r\n * controller.remapButton('left', 'throttle');\r\n * controller.remapButton('right', 'break');\r\n * \r\n * controller.buttons.throttle.on('keydown', ..);\r\n * ```\r\n *\r\n * @param {String} oldName button name we want to change\r\n * @param {String} newName new button name\r\n */\r\nController.prototype.remapButton = function (oldName, newName) {\r\n\r\n\t// handle old code\r\n\tif (newName.name) {\r\n\t\tnewName = newName.name;\r\n\t}\r\n\r\n\tif (this.buttons[oldName]) {\r\n\t\tthis.buttonAlias[oldName] = newName.name;\r\n\r\n\t\tthis.buttons[newName.name] = this.buttons[oldName];\r\n\r\n\t\tdelete this.buttons[oldName];\r\n\t} else {\r\n\t\tthrow Error('Button ' + oldName + ' was not found in controller');\r\n\t}\r\n};\r\n\r\n// ## Controllers \r\n\r\n/** ### OneButtonController\r\n *\r\n * Controller with only one button.\r\n * @class OneButtonController\r\n */\r\nexport function OneButtonController() {\r\n\tController.call(this);\r\n\r\n\t// * __name__: 'button' \r\n\t// * __key__: spacebar\r\n\tthis.addButton(new Button('button', 32));\r\n}\r\nOneButtonController.prototype = Object.create(Controller.prototype);\r\nOneButtonController.prototype.constructor = OneButtonController;\r\n\r\n\r\n/** ### TwoButtonController\r\n *\r\n * Controller with two buttons\r\n * @class TwoButtonController\r\n */\r\nexport function TwoButtonController() {\r\n\tController.call(this);\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('left', 37));\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('right', 39));\r\n}\r\nTwoButtonController.prototype = Object.create(Controller.prototype);\r\nTwoButtonController.prototype.constructor = TwoButtonController;\r\n\r\n\r\n/** ### TwoActionButtonsController\r\n *\r\n * Controller with two action buttons (A,B)\r\n * @class TwoActionButtonsController\r\n */\r\nexport function TwoActionButtonsController() {\r\n\tController.call(this);\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('A', 32));\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('B', 17));\r\n}\r\nTwoActionButtonsController.prototype = Object.create(Controller.prototype);\r\nTwoActionButtonsController.prototype.constructor = TwoActionButtonsController;\r\n\r\n\r\n/** ### FourButtonController\r\n *\r\n * Controller with four buttons\r\n * @class FourButtonController\r\n */\r\nexport function FourButtonController() {\r\n\tController.call(this);\r\n\r\n\t// * __name__: 'up'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('up', 38));\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('left', 37));\r\n\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('right', 39));\r\n\r\n\t// * __name__: 'A'\r\n\t// * __key__: spacebar\r\n\tthis.addButton(new Button('A', 32));\r\n}\r\nFourButtonController.prototype = Object.create(Controller.prototype);\r\nFourButtonController.prototype.constructor = FourButtonController;\r\n\r\n/** ### FiveButtonController\r\n *\r\n * Controller with five buttons\r\n * @class FiveButtonController\r\n */\r\nexport function FiveButtonController() {\r\n\tController.call(this);\r\n\r\n\t// * __name__: 'up'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('up', 38));\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('left', 37));\r\n\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('right', 39));\r\n\r\n\t// * __name__: 'down'\r\n\t// * __key__: down arrow\r\n\tthis.addButton(new Button('down', 40));\r\n\r\n\t// * __name__: 'A'\r\n\t// * __key__: spacebar\r\n\tthis.addButton(new Button('A', 32));\r\n}\r\nFiveButtonController.prototype = Object.create(Controller.prototype);\r\nFiveButtonController.prototype.constructor = FiveButtonController;\r\n\r\n/** ### SixButtonController\r\n *\r\n * Controller with six buttons\r\n * @class SixButtonController\r\n */\r\nexport function SixButtonController() {\r\n\tController.call(this);\r\n\r\n\t// * __name__: 'up'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('up', 38));\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('left', 37));\r\n\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('right', 39));\r\n\r\n\t// * __name__: 'down'\r\n\t// * __key__: down arrow\r\n\tthis.addButton(new Button('down', 40));\r\n\r\n\t// * __name__: 'A'\r\n\t// * __key__: spacebar\r\n\tthis.addButton(new Button('A', 32));\r\n\r\n\t// * __name__: 'B'\r\n\t// * __key__: ctrl\r\n\tthis.addButton(new Button('B', 17));\r\n}\r\nSixButtonController.prototype = Object.create(Controller.prototype);\r\nSixButtonController.prototype.constructor = SixButtonController;\r\n\r\n/** ### TwoArrowsOneButtonController\r\n *\r\n * Controller with two arrows and one action button\r\n * @class TwoArrowsOneButtonController\r\n */\r\nexport function TwoArrowsOneButtonController() {\r\n\tController.call(this);\r\n\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('left', 37));\r\n\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('right', 39));\r\n\r\n\r\n\t// * __name__: 'A'\r\n\t// * __key__: spacebar\r\n\tthis.addButton(new Button('A', 32));\r\n\r\n}\r\nTwoArrowsOneButtonController.prototype = Object.create(Controller.prototype);\r\nTwoArrowsOneButtonController.prototype.constructor = TwoArrowsOneButtonController;\r\n\r\n/** ### TwoArrowsTwoButtonsController\r\n *\r\n * Controller with two arrows and two action buttons\r\n * @class TwoArrowsTwoButtonsController\r\n */\r\nexport function TwoArrowsTwoButtonsController() {\r\n\tController.call(this);\r\n\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('left', 37));\r\n\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('right', 39));\r\n\r\n\r\n\t// * __name__: 'A'\r\n\t// * __key__: spacebar\r\n\tthis.addButton(new Button('A', 32));\r\n\r\n\t// * __name__: 'B'\r\n\t// * __key__: ctrl\r\n\tthis.addButton(new Button('B', 17));\r\n\r\n}\r\nTwoArrowsTwoButtonsController.prototype = Object.create(Controller.prototype);\r\nTwoArrowsTwoButtonsController.prototype.constructor = TwoArrowsTwoButtonsController;\r\n\r\n/** ### FourArrowController \r\n *\r\n * Controller with four arrow buttons\r\n * @class FourArrowController\r\n */\r\nexport function FourArrowController() {\r\n\tController.call(this);\r\n\r\n\t// * __name__: 'up'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('up', 38));\r\n\r\n\t// * __name__: 'left'\r\n\t// * __key__: left arrow\r\n\tthis.addButton(new Button('left', 37));\r\n\r\n\r\n\t// * __name__: 'right'\r\n\t// * __key__: righ arrow\r\n\tthis.addButton(new Button('right', 39));\r\n\r\n\t// * __name__: 'down'\r\n\t// * __key__: down arrow\r\n\tthis.addButton(new Button('down', 40));\r\n}\r\nFourArrowController.prototype = Object.create(Controller.prototype);\r\nFourArrowController.prototype.constructor = FourArrowController;\r\n\r\n/** ### TouchController \r\n *\r\n * This controller has no buttons. Instead it has a touchpad which\r\n * triggers *touchstart*, *touchend*, *touchmove*, *touchcancel*,\r\n * *touchend* events (similar to \r\n * [Touch event types](https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent#Touch_event_types))\r\n *\r\n * The position of the touch is in the `data.position` argument as a \r\n * *x* and *y* with the values between [0, 0] for the left top corner\r\n * and [1, 1] for the bottom right corner ([0.5, 0.5] is the center).\r\n *\r\n * ```javascript\r\n * controller = gamee.controller.requestController('Touch');\r\n *\r\n * controller.on('touchstart', function(data) {\r\n *\tif (data.position.x < 0.5 && data.position.y < 0.5) {\r\n *    console.log('touch in the top left quadrant');\r\n *  }\r\n * })\r\n * ```\r\n * @class TouchController\r\n */\r\nexport function TouchController() {\r\n\tvar self = this;\r\n\r\n\tController.call(this);\r\n\r\n\tthis.on(\"$touchstart\", function (data) {\r\n\t\tself.trigger('touchstart', data);\r\n\t});\r\n\r\n\tthis.on(\"$touchend\", function (data) {\r\n\t\tself.trigger('touchend', data);\r\n\t});\r\n\r\n\tthis.on(\"$touchmove\", function (data) {\r\n\t\tself.trigger('touchmove', data);\r\n\t});\r\n\r\n\tthis.on(\"$touchleave\", function (data) {\r\n\t\tself.trigger('touchleave', data);\r\n\t});\r\n\r\n\tthis.on(\"$touchcancel\", function (data) {\r\n\t\tself.trigger('touchcancel', data);\r\n\t});\r\n}\r\nTouchController.prototype = Object.create(TouchController.prototype);\r\nTouchController.prototype.constructor = TouchController;\r\n\r\n/** ### JoystickController \r\n *\r\n * JoystickController emits `change` event, after the position of the \r\n * joystick is changed. \r\n *\r\n * The position of the joystick is in the property `x` and `y`. The \r\n * position on axis is between <-1, 1> (for x -1 is max left \r\n * position, 1 max right position). [0.0, 0.0] is the center.\r\n *\r\n * ```javascript\r\n * joystick = gamee.controller.requestController('Joystick');\r\n *\r\n * joystick.on('change', function() {\r\n *   new_x = joystick.x;\r\n *   nex_y = joystick.y;\r\n * })\r\n * ```\r\n * @class JoystickController\r\n */\r\nexport function JoystickController() {\r\n\tvar self = this;\r\n\r\n\tController.call(this);\r\n\r\n\t// x axis\r\n\tthis.x = 0;\r\n\t// y axis\r\n\tthis.y = 0;\r\n\r\n\tthis.on(\"$change\", function (data) {\r\n\t\tself.x = data.position.x;\r\n\t\tself.y = data.position.y;\r\n\r\n\t\tself.trigger(\"change\", data);\r\n\t});\r\n}\r\nJoystickController.prototype = Object.create(Controller.prototype);\r\nJoystickController.prototype.constructor = JoystickController;\r\n\r\n/** ### JoystickButtonController \r\n *\r\n * JoystickButtonController is a `JoystickController` with one button.\r\n *\r\n * ```javascript\r\n * joystick = gamee.controller.requestController('JoystickWithButton');\r\n *\r\n * joystick.on('change', function() {\r\n *   new_x = joystick.x;\r\n *   nex_y = joystick.y;\r\n * })\r\n *\r\n * joystick.buttons.button.on('keydown', callback)\r\n * // or simply\r\n * joystick.on('keydown', callback)\r\n * ```\r\n * @class JoystickButtonController\r\n */\r\nexport function JoystickButtonController() {\r\n\tvar self = this;\r\n\r\n\tJoystickController.call(this);\r\n\r\n\t// * __name__: 'button' \r\n\t// * __key__: spacebar\r\n\tthis.addButton(new Button('button', 32));\r\n}\r\nJoystickButtonController.prototype = Object.create(JoystickController.prototype);\r\nJoystickButtonController.prototype.constructor = JoystickButtonController;\n\n\n// WEBPACK FOOTER //\n// ./gamee/src/game_controllers.js","import { } from \"../libs/shims.js\"\r\nimport { Gamee } from \"./gameeAPI.js\"\r\nimport { core } from \"./core.js\"\r\nimport { PlatformAPI, PlatformBridge, PostMessageBridge, MobileBridge, FacebookBridge } from \"./platform_bridge.js\"\r\n\r\n\r\n/**\r\n * Instance of gamee object with API for developers. \r\n * Internal functions becomes private this way\r\n * \r\n * @requires Gamee\r\n */\r\nexport var gamee;\r\n\r\n/**\r\n * Resolves what platform is being used and make instance of platform API. \r\n * \r\n * @requires PlatformBridge\r\n */\r\nvar platformBridge = (function () {\r\n\r\n    var platformBridge, platformType = \"web\";\r\n\r\n    // Reslove Gamee enviroment\r\n    /* current user agent */\r\n    var userAgent = navigator.userAgent.toLowerCase();\r\n\r\n    if ((window.parent !== window) && (/facebook/.test(document.referrer))) { // FB\r\n        // TODO fb platform\r\n        platformType = \"fb\";\r\n    } else if (/iphone|ipod|ipad/.test(userAgent)) { // test ios device\r\n        // user agent is use to determine current enviroment\r\n\r\n        // Test if window with game have a parent (loading in iframe)\r\n        if (window.self !== window.top) {\r\n            platformType = \"web\";\r\n        } else {\r\n            platformType = \"ios\";\r\n        }\r\n    } else if (/gamee\\/[0-9\\.]+$/.test(userAgent)) { // test android app\r\n        // TODO do you really test android like that?\r\n        platformType = \"android\";\r\n    } else if (window.parent) { // TODO doesnt make sence, parent always exists!!\r\n        platformType = \"web\";\r\n    } else if (window.parent && window.parent.gameeSimulator) { // TODO doesnt make sence, parent always exist?\r\n        platformType = \"web\";\r\n    }\r\n\r\n    gamee = new Gamee(platformType);\r\n\r\n    switch (platformType) {\r\n        case \"web\":\r\n            if (window.parent === window) {\r\n                console.error(\"Gamee must run in iframe on web platform\");\r\n            }\r\n            platformBridge = new PostMessageBridge(window.parent);\r\n            break;\r\n        case \"ios\":\r\n            platformBridge = new MobileBridge(\"ios\");\r\n            break;\r\n        case \"android\":\r\n            platformBridge = new MobileBridge(\"android\");\r\n            break;\r\n        case \"fb\":\r\n            platformBridge = new FacebookBridge(\"fb\");\r\n            break;\r\n        default:\r\n            throw \"Can't identify the platform\";\r\n    }\r\n    return platformBridge;\r\n})();\r\n\r\ncore.PlatformAPI = PlatformAPI;\r\ncore.native = platformBridge;\r\n\r\nPlatformAPI.emitter = gamee.emitter;\r\n\r\n\r\nfunction loadScript(url, callback) {\r\n    // Adding the script tag to the head as suggested before\r\n    var head = document.getElementsByTagName('head')[0];\r\n    var script = document.createElement('script');\r\n    script.src = url;\r\n\r\n    // Then bind the event to the callback function.\r\n    // There are several events for cross browser compatibility.\r\n    script.onreadystatechange = callback;\r\n    script.onload = callback;\r\n\r\n    // Fire the loading\r\n    head.appendChild(script);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./gamee/src/index.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 7\n// module chunks = 0"],"sourceRoot":""}